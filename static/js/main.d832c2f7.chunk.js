(this["webpackJsonp@riverscapes/warehouse"]=this["webpackJsonp@riverscapes/warehouse"]||[]).push([[0],{117:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(612);Object.defineProperty(t,"Footer",{enumerable:!0,get:function(){return o.default}});var i=n(613);Object.defineProperty(t,"Topbar",{enumerable:!0,get:function(){return i.default}});var l=n(706);Object.defineProperty(t,"WarehouseTags",{enumerable:!0,get:function(){return l.default}});var c=n(707);Object.defineProperty(t,"ProgramChooser",{enumerable:!0,get:function(){return c.default}}),a(n(708),t)},33:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(617),t),a(n(698),t),a(n(699),t);var o=n(700);Object.defineProperty(t,"typeDefs",{enumerable:!0,get:function(){return o.default}}),a(n(701),t),a(n(702),t),a(n(704),t)},333:function(e,t){},602:function(e,t,n){e.exports=n(942)},612:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(1)),o=r(n(172)),i=r(n(40)),l=n(36).makeStyles((function(){return{root:{display:"flex"},text:{flexGrow:1},logo:{}}}));t.default=function(e){var t=e.version,n=l();return a.default.createElement(o.default,{className:n.root,maxWidth:"md"},t&&a.default.createElement(i.default,{component:"div",className:n.text,color:"textSecondary",variant:"overline"},"v.",t),a.default.createElement("img",{className:n.logo,alt:"footer",src:"/cc-watermarks-riverscapes_orig.png"}))}},613:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isDisabled=void 0;var l=o(n(1)),c=i(n(106)),s=i(n(202)),u=i(n(173)),d=i(n(154)),p=i(n(233)),m=i(n(614)),g=i(n(615)),f=i(n(107)),h=i(n(616)),v=n(33),y=n(36),b=n(113),j=i(n(705)),S=y.makeStyles(j.default);function E(e){return(!e.meta||!e.meta.access||"PUBLIC"!==e.meta.access)&&null===e.role}t.isDisabled=E;t.default=function(e){var t=e.title,n=e.program,r=e.programs,a=e.signOutHandler,o=e.history,i=S(),y=l.useState(null),j=y[0],O=y[1],w=function(){return O(null)},P=o&&o.location.pathname.indexOf("/admin")>-1,x=(a||r)&&l.default.createElement(p.default,{anchorEl:j,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:!!j,onClose:w},r&&l.default.createElement(d.default,null,l.default.createElement(b.Typography,{variant:"overline",onClick:function(){return o.push("/")}},"Programs")),r&&l.default.createElement(u.default,null),r&&r.length>0&&r.map((function(e,t){return l.default.createElement(d.default,{disabled:n&&n.machineName===e.machineName||E(e),key:"prog-"+t,onClick:function(){return t=e,w(),void(o&&o.push("/"+t.machineName));var t},value:e.machineName},e.name)})),a&&l.default.createElement(u.default,null),a&&l.default.createElement(d.default,{onClick:a},"Log Out")),T=n&&(n.role===v.WarehouseRoleEnum.Admin||n.role===v.WarehouseRoleEnum.SuperUser);return l.default.createElement(l.default.Fragment,null,l.default.createElement(s.default,{position:"static"},l.default.createElement(c.default,{className:i.root,disableGutters:!0},l.default.createElement("a",{href:"http://riverscapes.xyz/"},l.default.createElement("img",{className:i.logo,src:"https://riverscapes.xyz/assets/images/RiverscapesLogo.png",alt:"logo"})),n?l.default.createElement("div",null,l.default.createElement(b.Typography,{variant:"subtitle1"},n.name),l.default.createElement(b.Typography,{variant:"caption"},t)):l.default.createElement(b.Typography,{variant:"subtitle1"},t),l.default.createElement("div",{className:i.spacer}),T&&l.default.createElement(f.default,{"aria-haspopup":"true",onClick:function(){o&&(P?o.push("/"+n.machineName):o.push("/"+n.machineName+"/admin"))},color:"inherit"},P?l.default.createElement(g.default,null):l.default.createElement(m.default,null)),(a||r)&&l.default.createElement(f.default,{"aria-haspopup":"true",onClick:function(e){return O(e.currentTarget)},color:"inherit"},l.default.createElement(h.default,null)))),x)}},617:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(t){o(t)}}function l(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(l){o=[6,l],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.verifyMeta=t.augmentXML=t.parseProjectXML=t.parseProgramXML=t.getXML=void 0;var c=n(618),s=l(n(444)),u=n(248),d=n(33),p=l(n(696));function m(e){return e.reduce((function(e,t){var n,a=t.val,o=t.attr.name;return r(r({},e),((n={})[o]=a&&a.trim(),n))}),{})}t.getXML=function(e){return a(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,s.default({url:e,method:"get"})];case 1:if(!(t=n.sent()).data)throw new Error("Error retrieving XML file");return[2,t.data]}}))}))},t.parseProgramXML=function(e){return a(this,void 0,void 0,(function(){var t,n,a,l,s,g,f,h,v,y,b,j,S;return o(this,(function(o){switch(o.label){case 0:return[4,c.parseStringPromise(e).catch((function(e){throw new d.ValidationError("Error parsing XML file. This likely means a broken or unclosed tag.",[e.message])}))];case 1:return t=o.sent(),n=u.util.arrToObj(t),a=n.Program,l=m(a.MetaData),s=l.apiUrl,g=l.projectFile,f=l.projectXSDs,h=i(l,["apiUrl","projectFile","projectXSDs"]),v=a.Definitions[0].Collections.map((function(e){var t=e.attr,n=e.Allow,a=e.AllowRegex;return r(r({},t),{Allow:n?Array.isArray(n)?n.map((function(e){return e.attr})):[n]:void 0,AllowRegex:a?Array.isArray(a)?a.map((function(e){return e.attr.pattern})):[a.pattern]:void 0})})),y=a.Definitions[0].Groups.map((function(e){return e.attr})),b=a.Definitions[0].Products.map((function(e){return e.attr})),j=(new p.default.DOMParser).parseFromString(e),S=function(e,t,n,a){var o=e.getElementsByTagName("Hierarchy")[0],i=Array.from(o.getElementsByTagName("Product")),l=[];return i.forEach((function(e){var o=[],i=e.getAttribute("ref"),c=t.find((function(e){return e.id===i}));if(!c)throw new Error("Product not found for ref='"+i+"'");for(var s=e.parentNode,u=function(){var e=s.getAttribute("ref"),t=s.tagName,r="Group"===t?n.find((function(t){return t.id===e})):a.find((function(t){return t.id===e})),i=r.folder,l=r.name;o.push({type:t,id:e,folder:i,name:l}),s=s.parentNode};s&&s.parentNode&&"Hierarchy"!==s.tagName;)u();l.push(r(r({},c),{pathArr:o.reverse()}))})),l}(j,b,y,v),[2,Promise.resolve(new d.Program({name:a.Name,machineName:a.MachineName,apiUrl:s,projectXSDs:f,projectFile:g,meta:h,products:S,collections:v,groups:y}))]}}))}))},t.parseProjectXML=function(e){return a(this,void 0,void 0,(function(){var t,n,r,a,i;return o(this,(function(o){switch(o.label){case 0:return[4,c.parseStringPromise(e).catch((function(e){throw new d.ValidationError("Error parsing XML file. This likely means a broken or unclosed tag.",[e.message])}))];case 1:return t=o.sent(),n=u.util.arrToObj(t),r=n.Project,a={},r.Warehouse&&(a=m(r.Warehouse)),i={},r.MetaData&&(i=m(r.MetaData)),[2,Promise.resolve({id:a.id,name:r.Name,projType:r.ProjectType,Warehouse:a,program:a.program,meta:i,tags:d.Project.parseTagString(a.tags),rawXML:e})]}}))}))},t.augmentXML=function(e,t){var n=(new p.default.DOMParser).parseFromString(t),r=n.getElementsByTagName("MetaData")[0];n.getElementsByTagName("Warehouse").length>0&&n.removeChild(n.getElementsByTagName("Warehouse")[0]);var a=n.createElement("Warehouse");return Object.keys(e).forEach((function(t){var r=n.createElement("Meta");r.setAttribute("name",t),r.appendChild(n.createTextNode(e[t])),a.appendChild(r)})),n.insertBefore(a,r),(new p.default.XMLSerializer).serializeToString(n)},t.verifyMeta=function(e,t,n){var r=n.products.find((function(t){return t.id===e}));if(!r)throw new Error("No project type '"+e+"' found in program '"+n.name+"'");return r.pathArr.filter((function(e){return"Collection"===e.type})).map((function(e){return{name:e.name,value:t[e.name]}}))}},632:function(e,t){},634:function(e,t){},698:function(e,t,n){"use strict";var r=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(t){o(t)}}function l(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(l){o=[6,l],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.adminGetUsers=t.adminUpdateUserPermissions=t.search=t.deleteProject=t.downloadZipFile=t.downloadFile=t.getUploadUrls=t.getProject=t.getProgram=t.getPrograms=t.validateProjectXML=t.authCheck=t.apiCall=void 0;var c,s,u,d,p,m,g,f,h,v,y,b,j=l(n(444)),S=n(940),E=l(n(459)),O=l(n(26)),w=n(33);t.apiCall=function(e,t,n,r){return j.default({url:e,method:"post",headers:t?{Authorization:"Bearer "+t}:null,data:{query:S.print(n),variables:r}}).then((function(e){return e.data})).catch((function(a){throw a.response&&404===a.response.status?new Error("API Url not found: "+e):a.code&&"ECONNREFUSED"===a.code?new Error("Connection refused. Could not contact: '"+e+"'"):(O.default.error("apiCall Error",{url:e,jwt:t,query:S.print(n),variables:r,err:a}),a)}))},t.authCheck=function(e,n){return t.apiCall(e,n,E.default(c||(c=r(["\n            query AuthCall {\n                auth {\n                    loggedIn\n                    userPool\n                    clientId\n                    region\n                    domain\n                }\n            }\n        "],["\n            query AuthCall {\n                auth {\n                    loggedIn\n                    userPool\n                    clientId\n                    region\n                    domain\n                }\n            }\n        "]))),{})},t.validateProjectXML=function(e,n,a,o,i){return t.apiCall(e,n,E.default(s||(s=r(["\n            query validateProject($xml: String!, $projType: String!, $program: String!) {\n                validate(xml: $xml, projType: $projType, program: $program) {\n                    result\n                    xmlErrors\n                }\n            }\n        "],["\n            query validateProject($xml: String!, $projType: String!, $program: String!) {\n                validate(xml: $xml, projType: $projType, program: $program) {\n                    result\n                    xmlErrors\n                }\n            }\n        "]))),{xml:a,program:i,projType:o})},t.getPrograms=function(e,n){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,t.apiCall(e,n,E.default(u||(u=r(["\n            query programs {\n                programs {\n                    name\n                    machineName\n                    apiUrl\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "],["\n            query programs {\n                programs {\n                    name\n                    machineName\n                    apiUrl\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "])))).then((function(e){return a(a({},e),{data:{programs:e.data.programs.map(w.Program.fromGraphQL)}})}))]}))}))},t.getProgram=function(e,n,a){return o(this,void 0,void 0,(function(){var o,l,c;return i(this,(function(i){switch(i.label){case 0:return[4,t.apiCall(e,n,E.default(d||(d=r(["\n            query program($program: String!) {\n                program(program: $program) {\n                    name\n                    machineName\n                    apiUrl\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "],["\n            query program($program: String!) {\n                program(program: $program) {\n                    name\n                    machineName\n                    apiUrl\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "]))),{program:a})];case 1:return o=i.sent(),l=o.data.program,c=o.errors,[2,{data:{program:w.Program.fromGraphQL(l)},errors:c}]}}))}))},t.getProject=function(e,n,l,c){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,t.apiCall(e,n,E.default(p||(p=r(["\n            query getProject($id: ID!, $program: String!) {\n                project(id: $id, program: $program) {\n                    id\n                    name\n                    projType\n                    totalSize\n                    program\n                    tags\n                    createdBy\n                    updatedBy\n                    createdOn\n                    updatedOn\n                    meta\n                    files {\n                        key\n                        md5\n                        size\n                        downloadUrl\n                    }\n                }\n            }\n        "],["\n            query getProject($id: ID!, $program: String!) {\n                project(id: $id, program: $program) {\n                    id\n                    name\n                    projType\n                    totalSize\n                    program\n                    tags\n                    createdBy\n                    updatedBy\n                    createdOn\n                    updatedOn\n                    meta\n                    files {\n                        key\n                        md5\n                        size\n                        downloadUrl\n                    }\n                }\n            }\n        "]))),{id:l,program:c}).then((function(e){return a(a({},e),{data:{project:w.Project.fromGraphQL(e.data.project)}})}))]}))}))},t.getUploadUrls=function(e,n,a,l,c,s){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,t.apiCall(e,n,E.default(m||(m=r(["\n            query requestUploadProject($id: ID, $files: [String!], $program: String!, $projectType: String!) {\n                requestUpload(id: $id, files: $files, program: $program, projectType: $projectType) {\n                    id\n                    uploadUrls {\n                        url\n                        fields\n                        origPath\n                    }\n                }\n            }\n        "],["\n            query requestUploadProject($id: ID, $files: [String!], $program: String!, $projectType: String!) {\n                requestUpload(id: $id, files: $files, program: $program, projectType: $projectType) {\n                    id\n                    uploadUrls {\n                        url\n                        fields\n                        origPath\n                    }\n                }\n            }\n        "]))),{id:a,files:l,projectType:c,program:s})];case 1:return[2,o.sent()]}}))}))},t.downloadFile=function(e,n,a,l,c,s){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,t.apiCall(e,n,E.default(g||(g=r(["\n            query downloadFileQuery($program: String!, $id: ID!, $projType: String!, $filePath: String!) {\n                downloadFile(program: $program, id: $id, projType: $projType, filePath: $filePath) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                }\n            }\n        "],["\n            query downloadFileQuery($program: String!, $id: ID!, $projType: String!, $filePath: String!) {\n                downloadFile(program: $program, id: $id, projType: $projType, filePath: $filePath) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                }\n            }\n        "]))),{projType:a,program:l,id:c,filePath:s})];case 1:return[2,o.sent()]}}))}))},t.downloadZipFile=function(e,n,a,l,c){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,t.apiCall(e,n,E.default(f||(f=r(["\n            query downloadZipFileQuery($program: String!, $id: ID!, $projType: String!) {\n                downloadZip(program: $program, id: $id, projType: $projType) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                    pendingSince\n                }\n            }\n        "],["\n            query downloadZipFileQuery($program: String!, $id: ID!, $projType: String!) {\n                downloadZip(program: $program, id: $id, projType: $projType) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                    pendingSince\n                }\n            }\n        "]))),{projType:a,program:l,id:c})];case 1:return[2,o.sent()]}}))}))},t.deleteProject=function(e,n,a,l){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,t.apiCall(e,n,E.default(h||(h=r(["\n            mutation deleteProject($id: ID!, $program: String!) {\n                deleteProject(id: $id, program: $program)\n            }\n        "],["\n            mutation deleteProject($id: ID!, $program: String!) {\n                deleteProject(id: $id, program: $program)\n            }\n        "]))),{program:l,id:a})];case 1:return[2,o.sent()]}}))}))},t.search=function(e,n,l,c){return o(this,void 0,void 0,(function(){var o,s,u,d,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.apiCall(e,n,E.default(v||(v=r(["\n            query searchQuery(\n                $program: String!\n                $projType: String\n                $nameStr: String\n                $metaStr: String\n                $metaArr: String\n                $tags: String\n                $limit: Int\n                $nextToken: Int\n            ) {\n                search(\n                    program: $program\n                    projType: $projType\n                    nameStr: $nameStr\n                    metaStr: $metaStr\n                    metaArr: $metaArr\n                    tags: $tags\n                    limit: $limit\n                    nextToken: $nextToken\n                ) {\n                    projects {\n                        id\n                        name\n                        projType\n                        program\n                        tags\n                        totalSize\n                        createdBy\n                        updatedBy\n                        createdOn\n                        updatedOn\n                        meta\n                        score\n                    }\n                    nextToken\n                    total\n                }\n            }\n        "],["\n            query searchQuery(\n                $program: String!\n                $projType: String\n                $nameStr: String\n                $metaStr: String\n                $metaArr: String\n                $tags: String\n                $limit: Int\n                $nextToken: Int\n            ) {\n                search(\n                    program: $program\n                    projType: $projType\n                    nameStr: $nameStr\n                    metaStr: $metaStr\n                    metaArr: $metaArr\n                    tags: $tags\n                    limit: $limit\n                    nextToken: $nextToken\n                ) {\n                    projects {\n                        id\n                        name\n                        projType\n                        program\n                        tags\n                        totalSize\n                        createdBy\n                        updatedBy\n                        createdOn\n                        updatedOn\n                        meta\n                        score\n                    }\n                    nextToken\n                    total\n                }\n            }\n        "]))),a(a({},c),{program:l}))];case 1:return(o=i.sent()).data?(s=o.data.search||{},u=s.nextToken,d=s.projects,p=s.total,[2,{errors:o.errors,data:{search:{projects:Array.isArray(d)?d.map(w.Project.fromGraphQL):d,nextToken:u,total:p}}}]):[2,{errors:o.errors}]}}))}))},t.adminUpdateUserPermissions=function(e,n,l,c,s){return o(this,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return[4,t.apiCall(e,n,E.default(y||(y=r(["\n            mutation project($id: ID!, $program: String!, $permission: String) {\n                updateUser(id: $id, program: $program, permission: $permission) {\n                    email\n                    name\n                    picture\n                    username\n                    createdOn\n                    updatedOn\n                    role\n                }\n            }\n        "],["\n            mutation project($id: ID!, $program: String!, $permission: String) {\n                updateUser(id: $id, program: $program, permission: $permission) {\n                    email\n                    name\n                    picture\n                    username\n                    createdOn\n                    updatedOn\n                    role\n                }\n            }\n        "]))),{program:c,id:l,permission:s})];case 1:return(o=i.sent()).data?[2,{errors:o.errors,data:{updateUser:o.data.updateUser?a(a({},o.data.updateUser),{createdOn:parseInt(o.data.updateUser.createdOn,10),updatedOn:parseInt(o.data.updateUser.updatedOn,10)}):null}}]:[2,{errors:o.errors}]}}))}))},t.adminGetUsers=function(e,n,l,c,s){return o(this,void 0,void 0,(function(){var o,u,d,p;return i(this,(function(i){switch(i.label){case 0:return[4,t.apiCall(e,n,E.default(b||(b=r(["\n            query getUsers($program: String!, $limit: Int, $nextToken: String) {\n                getUsers(program: $program, limit: $limit, nextToken: $nextToken) {\n                    users {\n                        email\n                        name\n                        picture\n                        username\n                        createdOn\n                        updatedOn\n                        role\n                    }\n                    nextToken\n                }\n            }\n        "],["\n            query getUsers($program: String!, $limit: Int, $nextToken: String) {\n                getUsers(program: $program, limit: $limit, nextToken: $nextToken) {\n                    users {\n                        email\n                        name\n                        picture\n                        username\n                        createdOn\n                        updatedOn\n                        role\n                    }\n                    nextToken\n                }\n            }\n        "]))),{program:l,limit:c,nextToken:s})];case 1:return(o=i.sent()).data?(u=o.data.getUsers||{},d=u.nextToken,p=u.users,[2,{errors:o.errors,data:{getUsers:{users:Array.isArray(p)?p.map((function(e){return a(a({},e),{createdOn:parseInt(e.createdOn,10),updatedOn:parseInt(e.updatedOn,10)})})):p,nextToken:d}}}]):[2,{errors:o.errors}]}}))}))}},699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WarehouseRoleEnum=t.FieldTypeEnum=void 0,function(e){e.string="S",e.number="N",e.boolean="BOOL",e.stringArr="SARR",e.numberArr="NARR"}(t.FieldTypeEnum||(t.FieldTypeEnum={})),function(e){e.SuperUser="SUPER",e.Admin="ADMIN",e.Observer="OBSERVER",e.Participant="PARTICIPANT"}(t.WarehouseRoleEnum||(t.WarehouseRoleEnum={}))},700:function(e,t,n){"use strict";var r=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o,i=a(n(459)).default(o||(o=r(["\n    # Check out the cheat sheet:\n    # https://raw.githubusercontent.com/sogko/graphql-shorthand-notation-cheat-sheet/master/graphql-shorthand-notation-cheat-sheet.png\n\n    schema {\n        query: Query\n        mutation: Mutation\n    }\n\n    type Query {\n        # Get a project and associated metadata\n        auth: AuthParams\n\n        project(id: ID!, program: String!): Project\n        projects(program: String!, projType: String, limit: Int, nextToken: String): PaginatedProjects\n\n        program(program: String!): Program\n        programs: [Program]\n\n        downloadFile(program: String!, id: ID!, projType: String!, filePath: String!): FileDownloadMeta\n\n        downloadZip(program: String!, id: ID!, projType: String!): FileDownloadMeta\n\n        # Request an upload start. Writes a manifest file on the upload bucket\n        # and creates upload urls for everything\n        requestUpload(id: ID, files: [String!], program: String!, projectType: String!): FileUpload\n\n        search(\n            program: String!\n            projType: String\n            nameStr: String\n            metaStr: String\n            metaArr: String\n            tags: String\n            limit: Int\n            nextToken: Int\n        ): PaginatedSearchResults\n\n        validate(xml: String!, projType: String!, program: String!): Validation\n\n        getUsers(program: String!, limit: Int, nextToken: String): PaginatedUsers\n    }\n\n    # this schema allows the following mutation:\n    type Mutation {\n        # signal a deletion of a project\n        deleteProject(id: ID!, program: String!): ID!\n        updateUser(id: ID!, program: String!, permission: String): User\n    }\n\n    type User {\n        email: String\n        name: String\n        picture: String\n        username: String!\n        createdOn: String\n        updatedOn: String\n        role: String\n    }\n\n    type PaginatedUsers {\n        users: [User]\n        nextToken: String\n    }\n\n    type Validation {\n        result: Boolean\n        xmlErrors: [String]\n    }\n\n    type AuthParams {\n        loggedIn: Boolean\n        userPool: String\n        clientId: String\n        region: String\n        domain: String\n    }\n\n    interface ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n    }\n\n    type Project implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        files: [FileDownloadMeta]\n    }\n\n    type ProjectSearchResult implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        score: Float\n        files: [FileDownloadMeta]\n    }\n\n    # This is mostly just JSON that's stringified\n    type Product {\n        id: ID!\n        name: String!\n        folder: String\n        # Stringified JSON Array:\n        pathArr: String\n    }\n    type Group {\n        id: ID!\n        name: String!\n        folder: String\n    }\n    type NamedAllow {\n        id: ID!\n        name: String!\n        aliases: String\n        folder: String\n    }\n    type Collection {\n        id: ID!\n        name: String!\n        AllowRegex: [String]\n        Allow: [NamedAllow]\n    }\n    type Program {\n        name: String\n        machineName: String\n        apiUrl: String\n        projectXSDs: String\n        projectFile: String\n        meta: String\n        groups: [Group]\n        collections: [Collection]\n        products: [Product]\n        hierarchy: String\n        role: String\n    }\n\n    type FileDownloadMeta {\n        key: String!\n        md5: String!\n        size: String\n        contentType: String\n        downloadUrl: String!\n        pendingSince: String\n    }\n\n    type FileUpload {\n        id: ID!\n        uploadUrls: [UploadUrl]\n    }\n\n    type UploadUrl {\n        url: String\n        fields: String\n        origPath: String\n    }\n\n    type FileUploadMeta {\n        key: String!\n        downloadUrl: String!\n    }\n\n    # Series Connection allows us to implement pagination easily\n    type PaginatedProjects {\n        projects: [Project]\n        nextToken: String\n    }\n\n    type PaginatedSearchResults {\n        projects: [ProjectSearchResult]\n        nextToken: Int\n        total: Int\n    }\n\n    type NewProject {\n        id: ID!\n    }\n"],["\n    # Check out the cheat sheet:\n    # https://raw.githubusercontent.com/sogko/graphql-shorthand-notation-cheat-sheet/master/graphql-shorthand-notation-cheat-sheet.png\n\n    schema {\n        query: Query\n        mutation: Mutation\n    }\n\n    type Query {\n        # Get a project and associated metadata\n        auth: AuthParams\n\n        project(id: ID!, program: String!): Project\n        projects(program: String!, projType: String, limit: Int, nextToken: String): PaginatedProjects\n\n        program(program: String!): Program\n        programs: [Program]\n\n        downloadFile(program: String!, id: ID!, projType: String!, filePath: String!): FileDownloadMeta\n\n        downloadZip(program: String!, id: ID!, projType: String!): FileDownloadMeta\n\n        # Request an upload start. Writes a manifest file on the upload bucket\n        # and creates upload urls for everything\n        requestUpload(id: ID, files: [String!], program: String!, projectType: String!): FileUpload\n\n        search(\n            program: String!\n            projType: String\n            nameStr: String\n            metaStr: String\n            metaArr: String\n            tags: String\n            limit: Int\n            nextToken: Int\n        ): PaginatedSearchResults\n\n        validate(xml: String!, projType: String!, program: String!): Validation\n\n        getUsers(program: String!, limit: Int, nextToken: String): PaginatedUsers\n    }\n\n    # this schema allows the following mutation:\n    type Mutation {\n        # signal a deletion of a project\n        deleteProject(id: ID!, program: String!): ID!\n        updateUser(id: ID!, program: String!, permission: String): User\n    }\n\n    type User {\n        email: String\n        name: String\n        picture: String\n        username: String!\n        createdOn: String\n        updatedOn: String\n        role: String\n    }\n\n    type PaginatedUsers {\n        users: [User]\n        nextToken: String\n    }\n\n    type Validation {\n        result: Boolean\n        xmlErrors: [String]\n    }\n\n    type AuthParams {\n        loggedIn: Boolean\n        userPool: String\n        clientId: String\n        region: String\n        domain: String\n    }\n\n    interface ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n    }\n\n    type Project implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        files: [FileDownloadMeta]\n    }\n\n    type ProjectSearchResult implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        score: Float\n        files: [FileDownloadMeta]\n    }\n\n    # This is mostly just JSON that's stringified\n    type Product {\n        id: ID!\n        name: String!\n        folder: String\n        # Stringified JSON Array:\n        pathArr: String\n    }\n    type Group {\n        id: ID!\n        name: String!\n        folder: String\n    }\n    type NamedAllow {\n        id: ID!\n        name: String!\n        aliases: String\n        folder: String\n    }\n    type Collection {\n        id: ID!\n        name: String!\n        AllowRegex: [String]\n        Allow: [NamedAllow]\n    }\n    type Program {\n        name: String\n        machineName: String\n        apiUrl: String\n        projectXSDs: String\n        projectFile: String\n        meta: String\n        groups: [Group]\n        collections: [Collection]\n        products: [Product]\n        hierarchy: String\n        role: String\n    }\n\n    type FileDownloadMeta {\n        key: String!\n        md5: String!\n        size: String\n        contentType: String\n        downloadUrl: String!\n        pendingSince: String\n    }\n\n    type FileUpload {\n        id: ID!\n        uploadUrls: [UploadUrl]\n    }\n\n    type UploadUrl {\n        url: String\n        fields: String\n        origPath: String\n    }\n\n    type FileUploadMeta {\n        key: String!\n        downloadUrl: String!\n    }\n\n    # Series Connection allows us to implement pagination easily\n    type PaginatedProjects {\n        projects: [Project]\n        nextToken: String\n    }\n\n    type PaginatedSearchResults {\n        projects: [ProjectSearchResult]\n        nextToken: Int\n        total: Int\n    }\n\n    type NewProject {\n        id: ID!\n    }\n"])));t.default=i},701:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;var a=function(){function e(e){Object.assign(this,e)}return e.fromGraphQL=function(t){if(!t)return null;var n=JSON.parse(t.meta);return new e(r(r({},t),{meta:n,role:t.role,products:t.products.map((function(e){return r(r({},e),{pathArr:JSON.parse(e.pathArr)})}))}))},e}();t.Program=a},702:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Project=void 0;var o=a(n(703));function i(e){e.sort((function(e,t){return e.children&&!t.children?-1:!e.children&&t.children?1:e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0}))}var l=function(){function e(e){var t=this;this.treeIzeFilePaths=function(){var e=[];return t.files.forEach((function(t){for(var n=t.key,r=n.split("/"),a=e,o=function(){var e={name:r.shift(),children:[]},t=a.find((function(t){return t.name===e.name}));t&&t.children?a=t.children:(a.push(e),a=e.children),i(a)};r.length>1;)o();a.push({name:r[0],path:n})})),i(e),e},Object.assign(this,e)}return e.fromGraphQL=function(t){return t?new e(r(r({},t),{meta:t.meta?JSON.parse(t.meta):{},tags:t.tags?t.tags.split(","):[]})):null},e.diff=function(e,t){var n=[],r=[];return t&&0!==t.length?e&&0!==e.length?{leftOnly:e.filter((function(e){var a=t.find((function(t){return e.key===t.key}));return a&&(a.md5===e.md5?r.push(e.key):n.push(e.key)),!a})).map((function(e){return e.key})),rightOnly:t.filter((function(t){return!e.find((function(e){return t.key===e.key}))})).map((function(e){return e.key})),different:n,same:r}:{leftOnly:[],rightOnly:t.map((function(e){return e.key})),different:[],same:[]}:{leftOnly:e.map((function(e){return e.key})),rightOnly:[],different:[],same:[]}},e.getProjectS3Keys=function(e,t,n){var r=o.default.join(e.machineName,n,t),a=r+".zip",i=o.default.join(r,e.projectFile),l=o.default.join(e.machineName,n,t+".zip.pending"),c=""+[e.machineName,n,t].join("-");return{prefix:r,zipKey:a,projFileKey:i,zipKeyPending:l,downloadFolderName:c,downloadZipFilename:c+".zip"}},e.parseDynamoMeta=function(e){var t=Object.keys(e).filter((function(e){return 0===e.indexOf("META_")})).reduce((function(t,n){var a,o=n.split("META_")[1];return r(r({},t),((a={})[o]=e[n],a))}),{});return JSON.stringify(t)},e.parseTagString=function(e){return e&&0!==e.trim().length?e.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0&&"null"!==e&&"undefined"!==e})):[]},e.parseS3Key=function(t,n){if(n.split("/").length<3)throw new Error("Not a valid project key");var r=n.split("/"),a=r[0],o=r[1],i=r[2];if(t.machineName!==a)throw new Error("Program passed to parseS3 key "+t.machineName+" does not correspond to program in key: "+a);return e.getProjectS3Keys(t,i,o)},e.parseS3KeyDUMB=function(e){var t=e.split("/");if(t.length<3)throw new Error("Not a valid project key");var n=t[0],r=t[1],a=t[2],i=o.default.join(n,r,a);return{programMachineName:n,projType:r,id:a,zipKey:i+".zip",prefix:i}},e}();t.Project=l},704:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.ValidationError=void 0;var a=function(e){function t(t,n){var r=e.call(this,t)||this;return r.name=r.constructor.name,r.reasons=n,Error.captureStackTrace(r,r.constructor),r}return r(t,e),t}(Error);t.ValidationError=a},705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36);t.default=function(e){var t,n,a,o;return{root:{display:"flex",alignItems:"center",width:"100%",padding:e.spacing(0,1),textShadow:"3px 3px 3px rgba(0,0,0,0.7)",backgroundImage:"url(/HeaderBackground.png)",backgroundRepeat:"no-repeat",backgroundPosition:"0% 50%",backgroundSize:"cover",backgroundColor:"#444444"},logo:{height:40,width:40,marginRight:e.spacing(2)},programChooser:{margin:e.spacing(0,1),color:e.palette.primary.contrastText,"& svg":{color:e.palette.primary.contrastText},"&:before":{borderColor:e.palette.primary.contrastText},"&:after":{borderColor:e.palette.primary.contrastText}},transparent:{backgroundColor:"transparent",background:"none",color:e.palette.text.primary},search:(t={position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:r.fade(e.palette.common.white,.15),"&:hover":{backgroundColor:r.fade(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%",flexGrow:1},t[e.breakpoints.up("sm")]={marginLeft:e.spacing(3),width:"auto"},t),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},spacer:{flexGrow:1},inputInput:(n={padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},n[e.breakpoints.up("sm")]={width:200},n),sectionDesktop:(a={display:"none"},a[e.breakpoints.up("sm")]={display:"flex",flexGrow:1},a),sectionMobile:(o={display:"flex",flexGrow:1},o[e.breakpoints.up("sm")]={display:"none"},o)}}},706:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(1)),i=n(113),l=a(n(40)),c=a(n(144)),s=n(36).makeStyles((function(e){return{root:{marginLeft:e.spacing(1)/2},tooltip:{maxWidth:220}}}));t.default=function(e){var t=e.tags,n=e.chipProps,a=s();return o.default.createElement(o.default.Fragment,null,t.map((function(e,t){return o.default.createElement(c.default,{key:"whTag-"+t,title:o.default.createElement(o.default.Fragment,null,o.default.createElement(l.default,{variant:"body1"},"Warehouse Tag: ",e),o.default.createElement(l.default,{variant:"caption"},"Warehouse tags can be added to delineate two identical projects in the warehouse"))},o.default.createElement(i.Chip,r({label:e},n,{className:a.root})))})))}},707:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isDisabled=void 0;var o=a(n(1)),i=a(n(72)),l=a(n(176)),c=a(n(40)),s=a(n(156)),u=a(n(240)),d=a(n(145)),p=a(n(206)),m=a(n(157)),g=a(n(344)),f=n(36),h=a(n(5)),v=n(117),y=f.makeStyles((function(e){return{rootContainer:{height:"100%",display:"flex",flexDirection:"column"},spacer:{flexGrow:1},root:{padding:e.spacing(2,4,4,4)},logoContainer:{padding:e.spacing(2),textAlign:"center"},logo:{},accessChip:r({},Object.keys(v.accessColors).reduce((function(t,n){var a;return r(r({},t),((a={})["&.access_"+n]={color:e.palette.getContrastText(v.accessColors[n][500]),background:v.accessColors[n][500]},a))}),{}))}}));function b(e){return(!e.meta||!e.meta.access||"PUBLIC"!==e.meta.access)&&null===e.role}t.isDisabled=b;t.default=function(e){var t=e.programs,n=e.history,r=e.navigate,a=y();return o.default.createElement("div",{className:a.rootContainer},o.default.createElement("div",{className:a.spacer}),o.default.createElement(i.default,{className:a.root,elevation:1},o.default.createElement("div",{className:a.logoContainer},o.default.createElement("img",{className:a.logo,src:"/RiverscapesLogo.png",alt:"logo"})),o.default.createElement(c.default,{variant:"h5"},"Choose a program:"),o.default.createElement(s.default,null,t&&t.map((function(e,t){var i=o.default.createElement(u.default,{icon:o.default.createElement(g.default,null),className:h.default(a.accessChip,"access_"+e.role),label:e.role||"Observer",color:"primary"}),c=b(e);return c&&(i=o.default.createElement(u.default,{label:"No Access",color:"default"})),o.default.createElement(d.default,{key:"progKey-"+t,disabled:c,button:!0,divider:!0,onClick:function(){return r(n,e)}},o.default.createElement(m.default,null,o.default.createElement(l.default,{alt:"programname"},e.name.substr(0,1))),o.default.createElement(p.default,{primary:e.name,secondary:e.meta.description}),i)}))),o.default.createElement(c.default,{paragraph:!0,variant:"caption"},"If there are programs labeled"," ",o.default.createElement(u.default,{label:"No Access",component:"span",color:"default",size:"small"})," and you think you should be able to see them please contact your program administrator.")),o.default.createElement("div",{className:a.spacer}))}},708:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.accessColors=void 0;var a=n(33),o=n(179);t.accessColors=((r={})[a.WarehouseRoleEnum.SuperUser]=o.pink,r[a.WarehouseRoleEnum.Admin]=o.red,r[a.WarehouseRoleEnum.Participant]=o.lime,r[a.WarehouseRoleEnum.Observer]=o.blue,r)},938:function(e,t,n){},942:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(37),i=n.n(o),l=n(45),c=n(125),s=n(21),u=n(120),d=n.n(u),p=n(148),m=n(67),g=n.n(m),f=n(26),h=n.n(f),v=n(424),y=n(992),b=n(995),j=n(996),S=n(997),E=n(425),O=n(550),w=n.n(O),P=n(129),x=Object(v.a)((function(e){return{root:{marginLeft:e.spacing(1)},titlebar:{display:"flex",background:e.palette.error.main,color:e.palette.error.contrastText},closeButton:{},name:{paddingLeft:e.spacing(1),flexGrow:1}}})),T=function(e){var t=e.onClose,n=e.program,r=x();return a.a.createElement(y.a,{onClose:t,open:!0,maxWidth:"xs",fullWidth:!0,className:r.root,classes:{}},a.a.createElement(b.a,{disableTypography:!0,className:r.titlebar},a.a.createElement(w.a,{color:"inherit"}),a.a.createElement(P.a,{className:r.name},"Access Denied")),a.a.createElement(j.a,{dividers:!0},a.a.createElement(P.a,{variant:"body1",component:"div",color:"inherit"},"You don't have access to the program ",a.a.createElement("strong",null,n.name),". If you arrived here via URL you will be able to use the URL again once you have access.")),a.a.createElement(S.a,null,a.a.createElement(E.a,{onClick:t,color:"primary"},"Back to programs")))},k=n(1002),C=n(468),N=n(340),I=n(429),_=n(557),D=n.n(_),A=n(951),U=n(556),R=n.n(U),$=n(553),F=n.n($),L=n(554),M=n.n(L),W=n(555),B=n.n(W),z=n(1006),G=n(558),q=n.n(G),Z=n(559),V=n.n(Z),X=n(117),K=n(5),Q=n(270),H=n.n(Q),J=n(151),Y=n.n(J),ee=n(186),te=n(460),ne=n(189),re=n(999),ae=n(271),oe=n.n(ae),ie=Object(v.a)((function(e){return{root:{marginLeft:e.spacing(1)},disabledButton:{opacity:.5}}})),le=function(e){var t=e.title,n=e.project,r=e.pendingSince,o=e.btnProps,i=e.downloadZipFile,l=ie(),c=a.a.createElement(C.a,{title:a.a.createElement(a.a.Fragment,null,a.a.createElement(P.a,{variant:"body1"},"Download Project Zip"),a.a.createElement(P.a,{variant:"caption",paragraph:!0},"Click to download this project as a single zip file"),a.a.createElement(P.a,{variant:"caption",paragraph:!0},"There may be a delay if the zip file needs to be built."))},a.a.createElement(E.a,Object.assign({variant:"outlined",color:"primary",onClick:function(e){e.preventDefault(),e.stopPropagation(),i(n)},startIcon:a.a.createElement(oe.a,null)},o),t||"ZIP"));return r&&(c=a.a.createElement(C.a,{title:a.a.createElement(a.a.Fragment,null,a.a.createElement(P.a,{variant:"body1"},"Preparing Zip"),a.a.createElement(P.a,{variant:"caption",paragraph:!0},"The warehouse is building your zip file for you."),a.a.createElement(P.a,{variant:"caption",paragraph:!0},"started ",Y()(r,"x").fromNow()))},a.a.createElement(E.a,Object.assign({variant:"outlined",disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0,color:"primary",onClick:function(e){e.preventDefault(),e.stopPropagation()},className:l.disabledButton,startIcon:a.a.createElement(re.a,{color:"secondary",size:24,thickness:3})},o),t||"ZIP"))),a.a.createElement("div",{className:l.root},c)},ce=n(1005),se=Object(v.a)((function(e){return{treeItemRoot:{backgroundColor:e.palette.background.paper,"&:nth-child(odd)":{backgroundColor:e.palette.background.default}},treeItemContainer:{display:"flex"},treeItemText:{marginLeft:e.spacing(1),padding:e.spacing(1),flexGrow:1},treeItemIcon:{},treeFile:{},treeFileContent:{borderBottom:"1px solid ".concat(e.palette.grey[100])},treeFolder:{},treeFolderContent:{},treeFolderText:{padding:e.spacing(1)},allowSelect:{"&,& *":{userSelect:"text",cursor:"auto"}}}})),ue=function e(t){var n=t.item,r=t.fileDict,o=t.keyStr,i=t.project,l=t.fileClick,c=se();if(n.children){var s=n.children.map((function(t,n){return a.a.createElement(e,{keyStr:"".concat(o,"-l").concat(n),key:"".concat(o,"-l").concat(n),item:t,fileDict:r,project:i,fileClick:l})}));return a.a.createElement(ce.a,{nodeId:o,className:c.treeFolder,classes:{content:c.treeFolderContent},label:a.a.createElement("div",{className:c.treeFolderText},n.name)},s)}var u=n.path?r[n.path]:null;return a.a.createElement(ce.a,{nodeId:o,className:c.treeFile,classes:{root:c.treeItemRoot,content:c.treeFileContent},label:a.a.createElement("div",{className:c.treeItemContainer},a.a.createElement("div",{className:c.treeItemText},a.a.createElement(P.a,{color:"textPrimary",component:"div",variant:"body1"},n.name),a.a.createElement(P.a,{color:"textSecondary",component:"div",variant:"caption"},H()(parseInt(u.size,10))," --"," ",a.a.createElement("span",{className:c.allowSelect},n.path))),a.a.createElement(C.a,{title:a.a.createElement(a.a.Fragment,null,a.a.createElement(P.a,{variant:"body1"},"Download: ",n.path))},a.a.createElement(N.a,{disableRipple:!0,className:c.treeItemIcon,color:"primary",onClick:function(){return l(i,n.path)}},a.a.createElement(oe.a,null)))),endIcon:u.icon})},de=Object(v.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},allowSelect:{"&,& *":{userSelect:"text",cursor:"auto"}},scrollPaper:{alignItems:"baseline"},name:{maxWidth:"95%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginBottom:e.spacing(1)},titlebar:{backgroundColor:"#444444",color:e.palette.primary.contrastText},flexGrow:{flexGrow:1},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},normalIcon:{},documentIcon:{color:ee.a[500]},photoIcon:{color:te.a[500]},TerrainIcon:{color:ne.a[500]},metaDisplay:{display:"flex",flexFlow:"wrap"},title:{marginTop:e.spacing(2)},treeItemContainer:{display:"flex"},treeItemText:{marginLeft:e.spacing(1),flexGrow:1},treeItemIcon:{},treeFileContent:{borderBottom:"1px solid ".concat(e.palette.grey[100]),padding:e.spacing(1)},treeFolder:{},treeFolderContent:{padding:e.spacing(1)},metaDisplayItem:{flex:"1 1",borderRadius:e.spacing(1),backgroundColor:"#fafafa",margin:e.spacing(1,.5),border:"#1px solid #e7e7e7",padding:e.spacing(1),maxWidth:"25%",minWidth:150,"&>*":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},prodChip:{marginLeft:e.spacing(1),backgroundColor:e.palette.primary.light,color:"white"},popOver:{padding:e.spacing(2)},subHeader:{width:"100%",display:"flex"}}})),pe=function(e){var t=e.onClose,n=e.project,o=e.downloadFile,i=e.program,u=e.pendingZips,d=e.downloadZipFile,p=de(),m=Object(r.useState)(null),g=Object(l.a)(m,2),f=g[0],h=g[1],v=u[n.id],S=[{pattern:/.*\.(png|gif|jpg|jpeg)$/i,icon:a.a.createElement(F.a,{className:p.photoIcon}),classStr:"photo"},{pattern:/.*\.(tif|img|shp)$/i,icon:a.a.createElement(M.a,{className:p.TerrainIcon}),classStr:"terrain"},{pattern:/.*\.(csv|pdf|doc)$/i,icon:a.a.createElement(B.a,{className:p.documentIcon}),classStr:"assignment"}],E=n.files.reduce((function(e,t){var n=S.find((function(e){var n=e.pattern;return t.key.match(n)}));return Object(s.a)(Object(s.a)({},e),{},Object(c.a)({},t.key,Object(s.a)(Object(s.a)({},t),{},{icon:n?n.icon:a.a.createElement(R.a,{className:p.normalIcon}),classStr:n?n.classStr:"normalIcon"})))}),{}),O=n.treeIzeFilePaths(),w=i.products.find((function(e){return e.id===n.projType})),x=w?w.name:"Unknown",T=Object.keys(n.meta).find((function(e){return"description"===e.toLowerCase()}));return a.a.createElement(y.a,{onClose:t,open:!0,maxWidth:"md",fullWidth:!0,className:p.root,classes:{scrollPaper:p.scrollPaper}},a.a.createElement(b.a,{disableTypography:!0,className:p.titlebar},a.a.createElement("div",null,a.a.createElement(C.a,{title:a.a.createElement(P.a,{variant:"body1"},n.name)},a.a.createElement(P.a,{variant:"h5",component:"div",className:Object(K.default)(p.name,p.allowSelect)},n.name)),a.a.createElement("div",{className:p.subHeader},a.a.createElement("div",{className:p.flexGrow},a.a.createElement(P.a,{variant:"caption",color:"inherit",component:"div"},"ID: ",a.a.createElement("span",{className:p.allowSelect},n.id))),a.a.createElement(le,Object.assign({title:"Download Project"},{project:n,pendingSince:v,downloadZipFile:d},{btnProps:{variant:"contained",color:"secondary",size:"small"}})))),t?a.a.createElement(N.a,{"aria-label":"close",className:p.closeButton,onClick:t},a.a.createElement(D.a,null)):null),a.a.createElement(j.a,{dividers:!0},a.a.createElement("div",{className:p.allowSelect},a.a.createElement(P.a,{variant:"caption",component:"div",color:"inherit"},a.a.createElement("strong",null,"Project Type"),": ",a.a.createElement("strong",null,x)," (",w&&w.id,")"),a.a.createElement(P.a,{variant:"caption",component:"div",color:"inherit"},a.a.createElement("strong",null,"Created"),": ",Y()(n.createdOn,"x").fromNow()," (",Y()(n.createdOn,"x").format("lll"),")"),a.a.createElement(P.a,{variant:"caption",component:"div",color:"inherit"},a.a.createElement("strong",null,"Updated"),": ",Y()(n.updatedOn,"x").fromNow()," (",Y()(n.updatedOn,"x").format("lll"),")"),a.a.createElement(P.a,{variant:"caption",component:"div",color:"inherit"},a.a.createElement("strong",null,"Warehouse tags:"),a.a.createElement(X.WarehouseTags,{tags:n.tags,chipProps:{size:"small",color:"secondary"}})),a.a.createElement(P.a,{variant:"caption",component:"div",color:"inherit"},a.a.createElement("strong",null,"Size (Unzipped)"),":"," ",n.totalSize&&n.totalSize>-1?H()(n.totalSize):"Not available"),T&&a.a.createElement("div",null,a.a.createElement(P.a,{className:p.title,color:"inherit",component:"div",variant:"subtitle1"},"Description"),a.a.createElement(P.a,{color:"textSecondary",variant:"body2"},n.meta[T])),a.a.createElement(P.a,{className:p.title,color:"inherit",variant:"subtitle1"},"Metadata"),a.a.createElement(I.a,null),a.a.createElement("div",{className:p.metaDisplay},Object.keys(n.meta).filter((function(e){return-1===["description"].indexOf(e.toLowerCase())})).map((function(e,t){var r=n.meta[e];return 0===n.meta[e].indexOf("http")&&(r=a.a.createElement(k.a,{href:n.meta[e],target:"_blank"},n.meta[e])),a.a.createElement(C.a,{key:"result-".concat(t),placement:"bottom",title:a.a.createElement(a.a.Fragment,null,a.a.createElement(P.a,{variant:"body1",component:"div"},a.a.createElement("strong",null,e)),a.a.createElement(P.a,{variant:"body2",component:"div"},r))},a.a.createElement("div",{className:p.metaDisplayItem},a.a.createElement(P.a,{variant:"caption",component:"div",color:"textPrimary"},a.a.createElement("strong",null,e)),a.a.createElement(P.a,{variant:"caption",component:"div",color:"textPrimary"},r)))})))),a.a.createElement(P.a,{className:p.title,color:"inherit",variant:"subtitle1"},"Files"),a.a.createElement(I.a,null),a.a.createElement(z.a,{className:p.treeRoot,defaultExpanded:["1"],disableSelection:!0,defaultCollapseIcon:a.a.createElement(q.a,{color:"inherit"}),defaultExpandIcon:a.a.createElement(V.a,{color:"inherit"})},O.map((function(e,t){return a.a.createElement(ue,{project:n,key:"treeNode-".concat(t),keyStr:"treeNode-".concat(t),item:e,fileDict:E,fileClick:o})})))),a.a.createElement(A.a,{open:Boolean(f),anchorEl:f?f[0]:null,onClose:function(){return h(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},a.a.createElement(P.a,{className:p.popOver},f?f[1]:"")))},me=n(84),ge=n(33),fe=n(194),he=n(339),ve=n(338),ye=n(464),be=n(548),je=n(549),Se=Object(v.a)((function(e){return{root:{padding:e.spacing(2),margin:e.spacing(2)},itemText:{flexGrow:1},spacer:{flexGrow:1},itemLine:{display:"flex"},mm:{display:"flex",width:"100%"},odd:{background:e.palette.background.default},mmItem:{},prodChip:{height:e.spacing(2.3),borderRadius:e.spacing(1)/2,color:"#999",border:"1px solid #ddd",background:"#eee",marginRight:e.spacing(1)},downloadText:{textAlign:"center",width:"100%"}}})),Ee=function(e){var t=e.project,n=e.onClick,r=e.program,o=e.pendingZips,i=e.odd,l=e.downloadZipFile,s=Se(),u=o[t.id],d=r.products.find((function(e){return e.id===t.projType})),p=d?d.pathArr.filter((function(e){return"Collection"===e.type})):[],m=d?d.name:"<UNKNOWN>",g=p.map((function(e){return{key:e.name,val:t.meta[e.name]}}),{});return a.a.createElement(ve.a,{button:!0,onClick:n,className:Object(K.default)(Object(c.a)({},s.odd,i))},a.a.createElement(ye.a,null,a.a.createElement(be.a,null," ",t.projType&&t.projType.substr(0,1)," ")),a.a.createElement("div",{className:s.itemText},a.a.createElement("div",{className:s.itemLine},a.a.createElement(P.a,{variant:"body1"},t.name),a.a.createElement("div",{className:s.spacer}),a.a.createElement(X.WarehouseTags,{tags:t.tags,chipProps:{size:"small",color:"secondary"}})),a.a.createElement("div",{className:s.mm},a.a.createElement(je.a,{className:s.prodChip,label:m,size:"small"}),g.map((function(e,t){var n=e.key,o=e.val,i=r.collections.find((function(e){return e.name===n})),l=i&&i.color?i.color[500]:"inherit";return a.a.createElement(P.a,{key:"mmval-".concat(t),className:s.mmItem,variant:"caption",color:"textSecondary"},t>0&&" \u2022 ",a.a.createElement("span",{style:{color:l}}," ",o," "))})))),a.a.createElement(le,{project:t,pendingSince:u,downloadZipFile:l}))},Oe=n(1003),we=n(1007),Pe=Object(v.a)((function(){return{root:{},itemText:{flexGrow:1}}})),xe=function(){var e=Pe();return a.a.createElement(ve.a,null,a.a.createElement(ye.a,null,a.a.createElement(we.a,{variant:"circle",height:40,width:40})),a.a.createElement("div",{className:e.itemText},a.a.createElement(we.a,{style:{height:10,width:"60%",margin:"6px 0"}}),a.a.createElement(we.a,{style:{height:10,width:"40%",margin:"6px 0"}})),a.a.createElement(Oe.a,null,a.a.createElement(N.a,{edge:"end",disabled:!0},a.a.createElement(we.a,{variant:"circle",height:40,width:40}))))},Te=Object(v.a)((function(e){return{root:{padding:e.spacing(2),margin:e.spacing(2)}}})),ke=function(e){var t=e.data,n=e.program,r=e.loading,o=e.searchParams,i=e.setSearchParams,l=e.pendingZips,c=e.navigate,u=e.downloadZipFile,d=Te();return r?a.a.createElement(fe.a,{className:d.root},a.a.createElement(me.PaginationWidget,{data:{total:0,startIndex:o.nextToken,pageSize:o.limit},loading:r,handlePaginationEvent:function(e){return i(Object(s.a)(Object(s.a)({},o),{},{nextToken:e}))}}),a.a.createElement(I.a,null),a.a.createElement(he.a,null,Array(o.limit||10).fill(null).map((function(e,t){return a.a.createElement(xe,{key:"result-".concat(t)})})))):t&&t.projects&&0!==t.projects.length?a.a.createElement(fe.a,{className:d.root},a.a.createElement(me.PaginationWidget,{data:{total:t.total,startIndex:o.nextToken,pageSize:o.limit},handlePaginationEvent:function(e){return i(Object(s.a)(Object(s.a)({},o),{},{nextToken:e}))}}),a.a.createElement(I.a,null),a.a.createElement(he.a,null,t&&t.projects.map((function(e,t){var r=new ge.Project(e);return a.a.createElement(Ee,{key:"result-".concat(t),odd:Boolean(t%2),project:r,program:n,pendingZips:l,downloadZipFile:u,onClick:function(){return c(n.machineName,r.id)}})})))):a.a.createElement(fe.a,{className:d.root},a.a.createElement("div",null,"No Projects Found"))},Ce=function(e){var t=e.getCurrentToken,n=e.url,o=e.navigate,i=e.program,c=e.searchParams,s=e.setSearchParams,u=e.pendingZips,m=e.downloadZipFile,g=Object(r.useState)(!0),f=Object(l.a)(g,2),v=f[0],y=f[1],b=Object(r.useState)(),j=Object(l.a)(b,2),S=j[0],E=j[1],O=Object(r.useState)(),w=Object(l.a)(O,2),P=w[0],x=w[1];return P&&h.a.error(P),Object(r.useEffect)((function(){function e(){return(e=Object(p.a)(d.a.mark((function e(){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return y(!0),e.next=5,t();case 5:return r=e.sent,h.a.debug("Search API Hit",{url:n,jwt:r,program:i.machineName,searchParams:c}),e.next=9,Object(ge.search)(n,r,i.machineName,c).then((function(e){var t=e.data,n=e.errors;try{if(n&&n.length>0)x(n),y(!1);else if(t){var r=t.search;E(r),y(!1)}}catch(a){y(!1)}})).catch((function(e){y(!1),x([e])}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}E(void 0),function(){e.apply(this,arguments)}()}),[i,n,c,t]),a.a.createElement(ke,{data:S,loading:v,navigate:o,program:i,searchParams:c,setSearchParams:s,pendingZips:u,downloadZipFile:m})};Ce.whyDidYouRender=!0;var Ne=Ce,Ie=n(166),_e=n(467),De=n(341),Ae=n(350),Ue=n(430),Re=n(342),$e=n(560),Fe=n.n($e),Le=n(188),Me=n(187),We=n(461),Be=n(462),ze=n(463),Ge=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_GRAPHQL:"https://iz2u8e5df2.execute-api.us-west-2.amazonaws.com/prod/api",REACT_APP_VERSION:"1.1.12"}).REACT_APP_DOMAIN;h.a.debug("config: ",{domain:Ge});var qe={graphql:"".concat("https://iz2u8e5df2.execute-api.us-west-2.amazonaws.com/prod/api")},Ze={limit:10,nextToken:0},Ve=[ee.a,ne.a,Le.a,Me.a,te.a,We.a,Be.a,ze.a],Xe=new URL("".endsWith("/")?"":"/",window.location.origin);console.log("RedirectUrl",{redirectUrl:Xe,publicUrl:""});var Ke=n(248),Qe=Object(v.a)((function(e){return{root:{display:"flex"},advancedLeft:{flex:"1 1 30%",height:e.spacing(4),marginRight:e.spacing(1)},advancedLeftCustom:{textAlign:"center"},advancedLeftOption:{},advancedText:{flex:"1 1 70%"},advancedRight:{flex:"1 1 70%"},advancedOp:{display:"flex"},advancedTextCustomName:{flex:"1 1 30%",marginRight:e.spacing(1)},advancedTextCustomValue:{flex:"1 1 40%"},advancedOpName:{flexGrow:1},advancedOpNamId:{},advancedInput:{height:e.spacing(4)}}})),He=function(e){var t=e.row,n=e.options,o=e.changeHandler,i=Qe(),c=Object(l.a)(t,2),s=c[0],u=c[1],d=Object(r.useState)(null),p=Object(l.a)(d,2),m=p[0],g=p[1],f=s&&s.length>0&&n.find((function(e){return e.name.toLowerCase()===s.toLowerCase()})),v=f&&f.Allow&&!!f.Allow.find((function(e){return e.name.toLowerCase()&&e.name.length>0})),y=Ke.util.debounce((function(e,t){var n=String(e),r=String(t);if(r&&r.length>0&&f&&!v){var a=f.AllowRegex;if(a&&a.length>0){var i=[];if(a.forEach((function(e){var t=new RegExp(e);!r.match(t)&&i.push(e)})),i.length>0)return void(1===i.length?g("Value must match pattern: '".concat(i[0],"'")):g(i.reduce((function(e,t,n){return e+(n>0?" and ":"")+t}),"Value must match patterns: ")))}}g(null),h.a.debug("CHANGING VALUES",[n,r]),n.toLowerCase()===s.toLowerCase()&&r.toLowerCase()===u.toLowerCase()||o([n,r])}),500),b=function(e){13===e&&s&&s.length>0&&(h.a.debug("Enter pressed"),o([s,u],!0))};return a.a.createElement("div",{className:i.root},a.a.createElement(De.a,{className:i.advancedLeft},a.a.createElement(Ae.a,{value:f?f.name:"__custom",inputProps:{className:i.advancedInput},onChange:function(e){return o([String(e.target.value),""],!0)}},a.a.createElement(Ue.a,{key:"aoss-custom",value:"__custom"},a.a.createElement(P.a,{className:i.advancedLeftCustom,color:"textSecondary"},a.a.createElement("em",null,"Custom"))),n.map((function(e,t){var n=e.name;return a.a.createElement(Ue.a,{key:"aoss-".concat(t),value:n},a.a.createElement(P.a,{className:i.advancedLeftOption},n))})))),v?a.a.createElement(De.a,{className:i.advancedRight},a.a.createElement(Ae.a,{value:u,inputProps:{className:i.advancedInput},onChange:function(e){return o([s,String(e.target.value)],!0)}},f&&f.Allow&&f.Allow.map((function(e,t){var n=e.id,r=e.name;return a.a.createElement(Ue.a,{className:i.advancedOp,key:"aooptss-".concat(t),value:n},a.a.createElement(P.a,{className:i.advancedOpName},r),r!==n&&a.a.createElement(P.a,{variant:"caption",className:i.advancedOpNamId},n))})))):f?a.a.createElement(_e.a,{error:!!m,label:m,disabled:!s||0===s.length,placeholder:"...",defaultValue:u,className:i.advancedText,inputProps:{className:i.advancedInput},onKeyDown:function(e){return b(e.keyCode)},onChange:function(e){return y(s,e.target.value)}}):a.a.createElement(a.a.Fragment,null,a.a.createElement(_e.a,{placeholder:"Meta Name",defaultValue:"",className:i.advancedTextCustomName,inputProps:{className:i.advancedInput},onKeyDown:function(e){return b(e.keyCode)},onChange:function(e){return y(e.target.value,u)}}),a.a.createElement(_e.a,{placeholder:"Meta Value",defaultValue:"",className:i.advancedTextCustomValue,inputProps:{className:i.advancedInput},onKeyDown:function(e){return b(e.keyCode)},onChange:function(e){return y(s,e.target.value)}})))},Je=Object(v.a)((function(e){return{root:{padding:e.spacing(2),margin:e.spacing(2)},spacer:{flexGrow:1},actionBar:{display:"flex",width:"100%","&>*":{marginLeft:e.spacing(1)}},advanced:{},iconButton:{},textField:{},projTypeLine:{display:"flex"},projType:{marginRight:e.spacing(1),flexGrow:1,maxWidth:300},resultsNum:{flexShrink:0},projTypeMenuItem:{display:"flex"},projTypeMenuItemSelected:{display:"flex"},projTypeMenuItemName:{flexGrow:1},projTypeMenuItemNum:{color:e.palette.text.secondary,fontSize:"0.75rem"}}})),Ye=function(e){var t,n,o,i=e.projTotals,c=e.program,u=e.searchParams,d=e.setSearchParams,p=Je(),m=Object(r.useState)([]),g=Object(l.a)(m,2),f=g[0],h=g[1],v=Object(r.useRef)(u),y=Object(r.useRef)();function b(e,t){var n=Object(s.a)({},e||v.current||u),r=Object(Ie.a)(t||f);"__all"===n.projType&&delete n.projType;var a=r&&r.length>0&&r.filter((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];return n&&r&&n.length>0&&r.length>0})),o=Object(s.a)({},n);a&&a.length>0&&(o.metaArr=JSON.stringify(a)),t&&h(t),d(o)}v.current=u,Object(r.useEffect)((function(){y.current&&(y.current.value=u.metaStr||"")}),[u]);var j=c&&c.products?Object.values(c.products).map((function(e){return{name:e.name,id:e.id}})):[],S=c?c.collections:[];S.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0})),j.sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0}));return a.a.createElement(fe.a,{className:p.root},c&&c.products&&a.a.createElement("div",{className:p.projTypeLine},a.a.createElement(De.a,{fullWidth:!0,className:p.projType},a.a.createElement(Re.a,{htmlFor:"projectType"},"Project Type"),a.a.createElement(Ae.a,{id:"projectType",inputProps:{className:p.projTypeMenuItemSelected},value:(null===(t=v.current)||void 0===t?void 0:t.projType)||"__all",onChange:function(e){var t="_all"!==e.target.value?e.target.value:void 0;b(Object(s.a)(Object(s.a)({},v.current),{},{projType:t}))}},a.a.createElement(Ue.a,{className:p.projTypeMenuItem,value:"__all"},a.a.createElement("div",{className:p.projTypeMenuItemName},"All Project Types"),a.a.createElement("div",{className:p.projTypeMenuItemNum},i.__all>-1?"".concat(i.__all):"...")),j.map((function(e,t){var n=e.name,r=e.id;return a.a.createElement(Ue.a,{className:p.projTypeMenuItem,key:"prod-".concat(t),value:r},a.a.createElement("div",{className:p.projTypeMenuItemName},n),a.a.createElement("div",{className:p.projTypeMenuItemNum},i[r]>-1?"".concat(i[r]):"..."))})))),a.a.createElement("div",{className:p.spacer}),a.a.createElement(De.a,{className:p.resultsNum},a.a.createElement(Re.a,{htmlFor:"resultsNum"},"Results"),a.a.createElement(Ae.a,{id:"resultsNum",value:null===(n=v.current)||void 0===n?void 0:n.limit,onChange:function(e){b(Object(s.a)(Object(s.a)({},v.current),{},{limit:e.target.value}))}},a.a.createElement(Ue.a,{value:10},"10"),a.a.createElement(Ue.a,{value:20},"20"),a.a.createElement(Ue.a,{value:50},"50"),a.a.createElement(Ue.a,{value:100},"100")))),a.a.createElement(_e.a,{id:"outlined-helperText2",label:"Metadata Search",fullWidth:!0,autoFocus:!0,placeholder:"...",inputRef:y,className:p.textField,margin:"normal",variant:"outlined",defaultValue:(null===(o=v.current)||void 0===o?void 0:o.metaStr)||"",onKeyDown:function(e){13===e.keyCode&&d(v.current)},onChange:function(e){v.current=Object(s.a)(Object(s.a)({},v.current),{},{metaStr:e.target.value})}}),f.length>0&&a.a.createElement("div",{className:p.advanced},f.map((function(e,t){return a.a.createElement(He,{key:"advRow-".concat(t),row:e,options:S.filter((function(e){return!f.find((function(n,r){return r!==t&&n[0]===e.name}))})),changeHandler:function(e,n){var r=Object(Ie.a)(f);r[t]=e,h(r),n&&b(null,r)}})})),a.a.createElement("div",null,a.a.createElement(E.a,{onClick:function(){return b(null,[].concat(Object(Ie.a)(f),[["",""]]))}},"+"),a.a.createElement(E.a,{onClick:function(){return b(null,f.slice(0,-1))}},"-"))),a.a.createElement("div",{className:p.actionBar},a.a.createElement(E.a,{color:"primary",onClick:function(){v.current&&(f.length>0?b(v.current,[]):b(v.current,[["",""]]))}},f.length>0?"Hide":"Show"," Advanced"),a.a.createElement("div",{className:p.spacer}),a.a.createElement(E.a,{className:p.iconButton,color:"primary",variant:"contained",onClick:function(){b(v.current)}},a.a.createElement(Fe.a,null)," Search"),a.a.createElement(E.a,{className:p.iconButton,color:"secondary",variant:"contained",onClick:function(){h([]),b(Ze)}},"Reset")))},et=function(e){var t=e.getCurrentToken,n=e.url,o=e.program,i=e.searchParams,u=e.setSearchParams,d=Object(r.useState)({}),p=Object(l.a)(d,2),m=p[0],g=p[1],f=Object(r.useRef)();return f.current=m,Object(r.useEffect)((function(){o&&n&&(t().then((function(e){return Object(ge.search)(n,e,o.machineName,{limit:0})})).then((function(e){var t=e.data;return t&&g(Object(s.a)(Object(s.a)({},f.current),{},{__all:t.search?t.search.total:0}))})).catch((function(e){h.a.error(e)})),o.products.reduce((function(e,r){return e.then((function(){return t().then((function(e){return Object(ge.search)(n,e,o.machineName,{projType:r.id,limit:0})})).then((function(e){var t=e.data;t&&g(Object(s.a)(Object(s.a)({},f.current),{},Object(c.a)({},r.id,t.search?t.search.total:0)))})).catch((function(e){g(Object(s.a)(Object(s.a)({},f.current),{},Object(c.a)({},r.id,0))),h.a.error(e)}))}))}),Promise.resolve()))}),[o,n,t]),a.a.createElement(Ye,{projTotals:m,program:o,searchParams:i,setSearchParams:u})};et.whyDidYouRender=!0;var tt=et,nt=function(e,t,n){var a=Object(r.useState)(),o=Object(l.a)(a,2),i=o[0],c=o[1],u=Object(r.useRef)();return u.current=i,Object(r.useEffect)((function(){if(e&&t&&e.params&&e.params.program)try{var r=null===t||void 0===t?void 0:t.find((function(t){return t.machineName===e.params.program}));!r||u.current&&u.current.machineName===r.machineName||(r.collections=r.collections.map((function(e,t){return Object(s.a)(Object(s.a)({},e),{},{color:Ve[t%Ve.length]})})),u.current=r,h.a.debug("useProgram",{match:e,newProg:r,programs:t}),c(r),n&&n(r))}catch(a){return}}),[e,t,n]),i},rt=function(e,t,n){var a=Object(r.useState)({loading:!1}),o=Object(l.a)(a,2),i=o[0],c=o[1],u=Object(r.useRef)();return u.current=i,Object(r.useEffect)((function(){if(t&&t.params){t.params.project||c({loading:!1});try{if(!n||!t||!t.params||!t.params.project||t.params.project.length<10)return;var r=n.machineName,a=!1;setTimeout((function(){a||c(Object(s.a)(Object(s.a)({},u.current),{},{loading:!0}))}),500),e.getCurrentToken().then((function(e){return Object(ge.getProject)(qe.graphql,e,t.params.project,r)})).then((function(e){var t;a=!0,h.a.debug("getProjectById::Response",e),e.data&&u.current&&u.current.project&&(null===(t=u.current)||void 0===t?void 0:t.project.id)===e.data.project.id||(e.data?c({project:e.data.project,loading:!1}):c({project:void 0,loading:!1}))})).catch((function(e){a=!0,c({project:void 0,loading:!1}),h.a.error("api.getProjectById error",e)}))}catch(o){return}}}),[t,n,e]),i},at=qe.graphql,ot=function(e){var t=e.match,n=e.history,o=e.auth,i=e.programs,u=Object(r.useState)({}),m=Object(l.a)(u,2),f=m[0],v=m[1],y=Object(r.useState)(Ze),b=Object(l.a)(y,2),j=b[0],S=b[1],E=Object(r.useRef)();E.current=f;var O=Object(r.useCallback)((function(e){S(Ze)}),[]),w=nt(t,i,O),x=rt(o,t,w),k=x.project,C=x.loading,N=Object(r.useCallback)((function(e,t){t&&t.length>10?n.push("/"+e+"/"+t):n.push("/"+e)}),[n]),I=Object(r.useCallback)(function(){var e=Object(p.a)(d.a.mark((function e(t,n){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.prev=2,e.next=5,o.getCurrentToken();case 5:return r=e.sent,e.next=8,Object(ge.downloadFile)(qe.graphql,r,t.projType,w.machineName,t.id,n);case 8:a=e.sent;try{a.data&&window.open(a.data.downloadFile.downloadUrl,"_self")}catch(i){h.a.error("DOWNLOAD err",i)}e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),h.a.error("DOWNLOAD err",e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,n){return e.apply(this,arguments)}}(),[w,o]),_=Object(r.useCallback)((function(e){if(!w)return Promise.resolve();return function t(){return o.getCurrentToken().then((function(t){return Object(ge.downloadZipFile)(qe.graphql,t,e.projType,w.machineName,e.id)})).then((function(n){try{n.data&&!n.data.downloadZip.pendingSince?(v(g.a.pickBy(E.current,(function(t,n){return n!==e.id}))),window.open(n.data.downloadZip.downloadUrl,"_self")):(v(Object(s.a)(Object(s.a)({},E.current),{},Object(c.a)({},e.id,n.data?n.data.downloadZip.pendingSince:Date.now()))),setTimeout(t,5e3))}catch(r){h.a.error("DOWNLOAD err",r)}})).catch((function(e){h.a.error("DOWNLOAD err",e)}))}()}),[w,o]),D=Object(r.useMemo)((function(){return k&&a.a.createElement(pe,{program:w,project:k,onClose:function(){w&&N(w.machineName)},downloadFile:I,pendingZips:f,downloadZipFile:_})}),[k,I,_,N,f,w]),A=w&&Object.values(ge.WarehouseRoleEnum).indexOf(w.role)>-1;h.a.info("App.Connect",{hasViewAccess:A,program:w});var U=Object(r.useMemo)((function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(tt,{getCurrentToken:o.getCurrentToken,url:at,program:w,searchParams:j,setSearchParams:S}),a.a.createElement(Ne,{getCurrentToken:o.getCurrentToken,url:at,navigate:N,program:w,searchParams:j,setSearchParams:S,pendingZips:f,downloadZipFile:_}))}),[j,w,f,_,o.getCurrentToken,N]);return w&&!A?a.a.createElement(T,{program:w,onClose:function(){return n.push("/")}}):a.a.createElement(a.a.Fragment,null,C&&a.a.createElement(me.Loading,{logoSVG:a.a.createElement(re.a,{size:"7rem",thickness:7}),status:a.a.createElement(P.a,{variant:"h5",component:"div"},"Loading Project..."),containerProps:{maxWidth:"xl",style:{position:"absolute",zIndex:1e3,top:0,left:0,width:"100%",height:"100%",background:"#FFFFFF77"}}}),U,D)},it=n(60),lt=n(561),ct=n(427),st=n(581),ut=n.n(st),dt=n(344),pt=n.n(dt),mt=n(580),gt=n.n(mt),ft=n(1e3),ht=n(465),vt=n(1004),yt=Object(v.a)((function(e){return{root:{},allowSelect:{userSelect:"text",cursor:"auto"},google:Object(s.a)(Object(s.a)({},e.typography.caption),{},{borderRadius:e.spacing(1.5),padding:e.spacing(.5,1),background:e.palette.primary.main,color:e.palette.primary.contrastText,marginLeft:e.spacing(2),border:"1px solid ".concat(e.palette.primary.dark)}),removeIcon:{marginLeft:e.spacing(2)}}})),bt=function(e){var t=e.user,n=e.onChange,r=e.isSuperUser,o=yt(),i=t.loading,l=function(e,r){e===ge.WarehouseRoleEnum.Admin?n(t.username,r?ge.WarehouseRoleEnum.Admin:ge.WarehouseRoleEnum.Participant):e===ge.WarehouseRoleEnum.Participant&&n(t.username,r?ge.WarehouseRoleEnum.Participant:ge.WarehouseRoleEnum.Observer)},c=t.role===ge.WarehouseRoleEnum.SuperUser;return a.a.createElement(ve.a,{disabled:i||c,className:o.root,divider:!0},a.a.createElement(ye.a,null,t.picture&&t.picture.length>0?a.a.createElement(be.a,{alt:t.name,src:t.picture}):a.a.createElement(be.a,{alt:t.name},a.a.createElement(pt.a,{color:"inherit"}))),a.a.createElement(ht.a,{id:"switch-list-label-wifi",primary:a.a.createElement("span",null,a.a.createElement("span",{className:o.allowSelect},t.name),t.username.startsWith("google")&&a.a.createElement("span",{className:o.google},"Google")),secondary:a.a.createElement("span",{className:o.allowSelect},t.email)}),t.role&&a.a.createElement(Oe.a,null,r&&!c&&a.a.createElement(ft.a,{control:a.a.createElement(vt.a,{edge:"end",onChange:function(e){return l(ge.WarehouseRoleEnum.Admin,e.target.checked)},checked:[ge.WarehouseRoleEnum.Admin,ge.WarehouseRoleEnum.SuperUser].indexOf(t.role)>-1,disabled:i||[ge.WarehouseRoleEnum.Observer].indexOf(t.role)>-1,inputProps:{"aria-labelledby":"switch-list-label-wifi"}}),labelPlacement:"start",label:"Program Admin"}),!c&&a.a.createElement(ft.a,{control:a.a.createElement(vt.a,{edge:"end",onChange:function(e){return l(ge.WarehouseRoleEnum.Participant,e.target.checked)},checked:[ge.WarehouseRoleEnum.Participant,ge.WarehouseRoleEnum.Admin,ge.WarehouseRoleEnum.SuperUser].indexOf(t.role)>-1,disabled:i||[ge.WarehouseRoleEnum.Admin,ge.WarehouseRoleEnum.SuperUser].indexOf(t.role)>-1,inputProps:{"aria-labelledby":"switch-list-label-wifi"}}),labelPlacement:"start",label:"Participant"}),!c&&a.a.createElement(C.a,{title:"Remove this user from the program"},a.a.createElement(a.a.Fragment,null,a.a.createElement(N.a,{edge:"end",className:o.removeIcon,"aria-label":"delete",color:"secondary",disabled:i,onClick:function(){return n(t.username,null)}},a.a.createElement(gt.a,null))))),!t.role&&a.a.createElement(Oe.a,null,a.a.createElement(C.a,{title:"Add this user to the program"},a.a.createElement(a.a.Fragment,null,a.a.createElement(N.a,{edge:"end","aria-label":"delete",color:"secondary",disabled:i,onClick:function(){return n(t.username,ge.WarehouseRoleEnum.Observer)}},a.a.createElement(ut.a,null))))))},jt=n(1001),St=n(587),Et=n(582),Ot=n.n(Et),wt=Object(v.a)((function(e){return{root:{display:"flex",overflow:"hidden",flexDirection:"column",margin:e.spacing(2)},description:{margin:e.spacing(0,2)},list:{flexGrow:1,overflow:"scroll",margin:e.spacing(1,2)},formControl:{margin:e.spacing(1,2)}}})),Pt=function(e){var t=e.users,n=e.onChange,o=e.title,i=e.description,c=e.isSuperUser,s=wt(),u=Object(r.useState)(),d=Object(l.a)(u,2),p=d[0],m=d[1],g=Object(r.useMemo)((function(){if(p&&p.length>=3){var e=p.split(" ").filter((function(e){return e.length>=3}));return t.filter((function(t){return e.every((function(e){return t.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1||t.email.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1}))}))}return t}),[t,p]);return a.a.createElement(fe.a,{className:s.root},a.a.createElement(ct.a,null,a.a.createElement(P.a,{variant:"subtitle1"},o)),a.a.createElement(P.a,{className:s.description,variant:"caption"},i||" "),a.a.createElement(De.a,{className:s.formControl},a.a.createElement(St.a,{fullWidth:!0,onChange:function(e){return m(e.target.value)},startAdornment:a.a.createElement(jt.a,{position:"start"},a.a.createElement(Ot.a,null))})),a.a.createElement(he.a,{className:s.list},g.map((function(e,t){return a.a.createElement(bt,{key:"userRow-".concat(t),user:e,onChange:n,isSuperUser:c})}))))},xt=Object(v.a)((function(e){return{rootContainer:{height:"100%",width:"100%",overflow:"hidden",position:"relative"},root:{height:"100%",width:"100%",display:"flex",overflow:"hidden",flexDirection:"column"},paperContainer:{display:"flex",width:"100%",height:"100%",overflow:"hidden","&>:first-child":{flex:"1 1 60%"},"&>:last-child":{flex:"1 1 40%"}},instructions:{color:e.palette.primary.contrastText,background:e.palette.primary.main,margin:e.spacing(2),padding:e.spacing(2)},list:{flexGrow:1,overflow:"scroll",margin:e.spacing(1,2)},loading:{background:"#FFFFFFCC",position:"absolute",zIndex:1e3}}}));function Tt(e){e.sort((function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())}))}var kt=function(e){var t=e.users,n=e.program,r=e.loading,o=e.isSuperUser,i=e.onChange,l=xt(),c=t.filter((function(e){return e.role}));Tt(c);var s=t.filter((function(e){return!e.role}));Tt(s);var u=n&&n.meta&&n.meta.access&&"PUBLIC"===n.meta.access,d=a.a.createElement("img",{src:"/RiverscapesLogo.png",alt:"logo"});return a.a.createElement("div",{className:l.rootContainer},r&&a.a.createElement(me.Loading,{logoSVG:d,title:"Riverscapes Warehouse",message:"Loading Users: ".concat(t.length),containerProps:{maxWidth:"xl",className:l.loading}}),a.a.createElement("div",{className:l.root},a.a.createElement(fe.a,{className:l.instructions},a.a.createElement(P.a,{variant:"h4",color:"inherit"},"User admin: ",n&&n.name),u?a.a.createElement(P.a,{variant:"body2",color:"inherit"},"This program is ",a.a.createElement("strong",null,"public"),". All authenticated users in the Riverscapes user pool will be able to see and download projects.",a.a.createElement("strong",null,"Participants")," can add or remove projects."):a.a.createElement(P.a,{variant:"body2",color:"inherit"},"This program is ",a.a.createElement("strong",null,"private")," so you have to explicitly add users to view it."," ",a.a.createElement("strong",null,"Participants")," can add or remove projects.")),a.a.createElement("div",{className:l.paperContainer},a.a.createElement(Pt,{users:c,onChange:i,isSuperUser:o,title:"Current program users:",description:"Everyone in this list is an Observer and can view and download all projects."}),a.a.createElement(Pt,{users:s,onChange:i,isSuperUser:o,title:"Add users:",description:u?"Users in this list CAN see everything in the program because the program is PUBLIC":"Users in this list cannot see or donwload projects in this program"}))))},Ct=function(e){var t=e.match,n=e.programs,o=e.auth,i=e.history,c=Object(r.useState)({users:[],loading:!0}),u=Object(l.a)(c,2),m=u[0],g=u[1],f=Object(r.useRef)(),v=Object(r.useRef)();f.current=m;var y=nt(t,n);Object(r.useEffect)((function(){i&&y&&y.role!==ge.WarehouseRoleEnum.SuperUser&&y.role!==ge.WarehouseRoleEnum.Admin&&i.push("/".concat(y.machineName))}),[y,i]),Object(r.useEffect)((function(){function e(){return(e=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0;case 1:if(!t&&!v.current){e.next=8;break}return t=!1,e.next=5,o.getCurrentToken().then((function(e){return Object(ge.adminGetUsers)(qe.graphql,e,null===y||void 0===y?void 0:y.machineName,50,v.current)})).then((function(e){var t,n,r,a=null===(t=e.data)||void 0===t?void 0:t.getUsers.nextToken,i=o.user?o.user.accessToken.payload.username:"NOBODY",l=((null===(n=e.data)||void 0===n?void 0:n.getUsers.users)||[]).filter((function(e){return e.username!==i}));return g({users:[].concat(Object(Ie.a)((null===(r=f.current)||void 0===r?void 0:r.users)||[]),Object(Ie.a)(l)),loading:Boolean(a)}),a})).catch((function(e){h.a.error(e)}));case 5:v.current=e.sent,e.next=1;break;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}y&&o&&function(){e.apply(this,arguments)}()}),[y,o]);var b=Object(r.useCallback)((function(e,t){var n=f.current.users.find((function(t){return t.username===e}));if(!n)throw new Error("Could not find user to change permissions of");var r=Object.assign({},n);g(Object(s.a)(Object(s.a)({},f.current),{},{users:f.current.users.map((function(n){return n.username!==e?n:Object(s.a)(Object(s.a)({},n),{},{role:t,loading:!0})}))}));var a=function(){h.a.error("ADMIN:::Operation failed. Putting the record back"),g(Object(s.a)(Object(s.a)({},f.current),{},{users:f.current.users.map((function(t){return t.username!==e?t:r}))}))},i=setTimeout(a,3e3);return o.getCurrentToken().then((function(n){return Object(ge.adminUpdateUserPermissions)(qe.graphql,n,e,null===y||void 0===y?void 0:y.machineName,t)})).then((function(t){clearTimeout(i),g(Object(s.a)(Object(s.a)({},f.current),{},{users:f.current.users.map((function(n){var r;return n.username!==e?n:Object(s.a)(Object(s.a)(Object(s.a)({},n),null===(r=t.data)||void 0===r?void 0:r.updateUser),{},{loading:!1})}))})),h.a.debug("Admin UPDATE",t)})).catch((function(e){h.a.error("User update query failure",e),a()}))}),[o,y]);return a.a.createElement(kt,{users:m.users,isSuperUser:Boolean(y&&y.role===ge.WarehouseRoleEnum.SuperUser),onChange:b,loading:Boolean(m.loading),program:y})},Nt=n(583),It=n.n(Nt),_t=Object(v.a)((function(e){return{rootContainer:{height:"100%",display:"flex",flexDirection:"column"},spacer:{flexGrow:1},root:{padding:e.spacing(2,4,4,4)},logoContainer:{padding:e.spacing(2),textAlign:"center"},logo:{}}})),Dt=function(e){var t=e.signIn,n=_t();return a.a.createElement("div",{className:n.rootContainer},a.a.createElement("div",{className:n.spacer}),a.a.createElement(fe.a,{className:n.root},a.a.createElement("div",{className:n.logoContainer},a.a.createElement("img",{className:n.logo,src:"/RiverscapesLogo.png",alt:"logo"})),a.a.createElement(P.a,{paragraph:!0,variant:"body1"},"Welcome to the Riverscapes Warehouse. Please click the button below to log in."),a.a.createElement(P.a,{paragraph:!0,variant:"body1"},"If you don't have an account you will be prompted to use your Google account or create a new account using another email address."),a.a.createElement(E.a,{variant:"contained",onClick:t,color:"primary",fullWidth:!0,size:"large",startIcon:a.a.createElement(It.a,null)},"Sign In")),a.a.createElement("div",{className:n.spacer}))},At=n(998),Ut=n(180),Rt={palette:{primary:{main:n(184).a[500]},secondary:{main:Me.a[600],contrastText:"#FFFFFF"},text:{}}},$t=Object(s.a)(Object(s.a)({},Rt),{},{palette:Object(s.a)(Object(s.a)({},Rt.palette),{},{type:"dark"})}),Ft={home:Object(Ut.a)(Rt),homeDark:Object(Ut.a)($t)},Lt=function(e){var t=e.children,n=e.match,r=e.history,o=e.programs,i=e.signOut,l=e.containerProps,c=e.noScroll,u=nt(n,o);return a.a.createElement(At.a,{theme:Ft.home},a.a.createElement(me.AppFrame,{containerProps:Object(s.a)({maxWidth:u?"md":"sm"},l),noScroll:c,topbar:a.a.createElement(X.Topbar,{history:r,programs:o,title:"Riverscapes Warehouse",signOutHandler:i,program:u}),footer:a.a.createElement(X.Footer,{version:"1.1.12"})},t))},Mt=function(){var e=Object(r.useState)(),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)(),c=Object(l.a)(i,2),s=c[0],u=c[1],d=Object(r.useState)(!0),p=Object(l.a)(d,2),m=p[0],g=p[1],f=Object(lt.useHosted)(n,!1,!1),v=Object(it.f)();Object(r.useEffect)((function(){Object(ge.authCheck)(qe.graphql,"").then((function(e){var t;h.a.debug("authResp",e);var n=null===(t=e.data)||void 0===t?void 0:t.auth;n&&n.region&&(o({region:n.region,userPoolId:n.userPool,userPoolWebClientId:n.clientId,mandatorySignIn:!0,oauth:{domain:n.domain,scope:["email","profile","openid"],redirectSignIn:Xe.toString(),redirectSignOut:Xe.toString(),responseType:"code"}}),g(!1))})).catch((function(e){h.a.error("api.getPrograms error",e)}))}),[]),Object(r.useEffect)((function(){if(v){var e=localStorage.getItem("RSUrl"),t=v.location.pathname;h.a.debug("LOCALSTORAGE:::REDIRECT checking",e,t,f),f.isAuthenticated||f.error||!f.isAuthComplete||(h.a.debug("LOCALSTORAGE:::SET",t),localStorage.setItem("RSUrl",t)),e&&f.isAuthenticated&&f.isAuthComplete&&!f.error&&(t!==e&&(h.a.debug("LOCALSTORAGE:::REDIRECT",t,e),v.push(e)),localStorage.removeItem("RSUrl"))}}),[v,f]);var y=Object(r.useCallback)((function(e,t,n){n?e.push("/"+t.machineName+"/"+n.id):e.push("/"+t.machineName)}),[]);Object(r.useEffect)((function(){f.isAuthenticated&&!(null===s||void 0===s?void 0:s.programs)&&(u({programs:[],loading:!0}),f.getCurrentToken().then((function(e){return Object(ge.getPrograms)(qe.graphql,e)})).then((function(e){h.a.debug("API GetPrograms",e),e.data&&e.data.programs&&u({programs:e.data.programs,loading:!1})})).catch((function(e){h.a.error("api.getPrograms error",e)})))}),[f,s]);var b=a.a.createElement("img",{src:"/RiverscapesLogo.png",alt:"logo"});if(m)return a.a.createElement(Lt,null,a.a.createElement(me.Loading,{logoSVG:b,title:"Riverscapes Warehouse",message:"Loading authentication info",version:"1.1.12"}));if(f.isAuthenticated){if(!s||(null===s||void 0===s?void 0:s.loading))return a.a.createElement(Lt,null,a.a.createElement(me.Loading,{logoSVG:b,title:"Riverscapes Warehouse",message:"Loading Programs",version:"1.1.12"}));var j={navigate:y,signOut:f.signOut,programs:null===s||void 0===s?void 0:s.programs};return a.a.createElement(it.c,null,a.a.createElement(it.a,{path:"/:program/admin",render:function(e){return a.a.createElement(Lt,Object.assign({},e,j,{noScroll:!0,containerProps:{maxWidth:"lg"}}),a.a.createElement(Ct,Object.assign({},e,{programs:null===s||void 0===s?void 0:s.programs,auth:f})))}}),a.a.createElement(it.a,{path:"/:program/:project?",render:function(e){return a.a.createElement(Lt,Object.assign({},e,j),a.a.createElement(ot,Object.assign({},e,{auth:f,programs:null===s||void 0===s?void 0:s.programs})))}}),a.a.createElement(it.a,{path:"/",render:function(e){return a.a.createElement(Lt,Object.assign({},e,j,{containerProps:{maxWidth:"sm"}}),a.a.createElement(X.ProgramChooser,Object.assign({},e,{navigate:y,programs:null===s||void 0===s?void 0:s.programs})))}}),a.a.createElement(it.a,{path:"*",render:function(e){return a.a.createElement(Lt,Object.assign({},e,j),"404 Not found")}}))}return f.isAuthComplete?a.a.createElement(Lt,{noScroll:!0},a.a.createElement(Dt,{signIn:f.signIn})):a.a.createElement(Lt,null,a.a.createElement(me.Loading,{logoSVG:b,title:"Riverscapes Warehouse",message:"Authenticating",version:"1.1.12"}))},Wt=n(253),Bt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function zt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(938);Object(me.devSetup)(),n(939),i.a.render(a.a.createElement(Wt.a,{basename:"/"},a.a.createElement(Mt,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Bt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):zt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):zt(t,e)}))}}(),window.addEventListener("load",(function(){window.history.pushState({},"")})),navigator.storage&&navigator.storage.persist?navigator.storage.persist().then((function(e){e?h.a.debug("Storage will not be cleared except by explicit user action"):h.a.warn("Storage may be cleared by the UA under storage pressure.")})):h.a.warn("navigator.storage API not implemented.")}},[[602,1,2]]]);
//# sourceMappingURL=main.d832c2f7.chunk.js.map