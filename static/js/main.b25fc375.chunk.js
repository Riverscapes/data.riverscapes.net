(this["webpackJsonp@riverscapes/warehouse"]=this["webpackJsonp@riverscapes/warehouse"]||[]).push([[0],{113:function(e,n,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return n[t]}})}:function(e,n,t,r){void 0===r&&(r=t),e[r]=n[t]}),a=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||n.hasOwnProperty(t)||r(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0});var o=t(630);Object.defineProperty(n,"Footer",{enumerable:!0,get:function(){return o.default}});var i=t(631);Object.defineProperty(n,"Topbar",{enumerable:!0,get:function(){return i.default}});var c=t(724);Object.defineProperty(n,"WarehouseTags",{enumerable:!0,get:function(){return c.default}});var s=t(725);Object.defineProperty(n,"ProgramChooser",{enumerable:!0,get:function(){return s.default}}),a(t(482),n)},29:function(e,n,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return n[t]}})}:function(e,n,t,r){void 0===r&&(r=t),e[r]=n[t]}),a=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||n.hasOwnProperty(t)||r(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),a(t(636),n),a(t(716),n),a(t(717),n);var o=t(718);Object.defineProperty(n,"typeDefs",{enumerable:!0,get:function(){return o.default}}),a(t(719),n),a(t(720),n),a(t(722),n)},359:function(e,n){},482:function(e,n,t){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),n.accessColors=void 0;var a=t(29),o=t(178);n.accessColors=((r={})[a.WarehouseRoleEnum.SuperUser]=o.pink,r[a.WarehouseRoleEnum.Admin]=o.red,r[a.WarehouseRoleEnum.Participant]=o.lime,r[a.WarehouseRoleEnum.Observer]=o.blue,r)},630:function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=r(t(0)),o=r(t(168)),i=r(t(37)),c=t(33).makeStyles((function(){return{root:{display:"flex"},text:{flexGrow:1},logo:{}}}));n.default=function(e){var n=e.version,t=c();return a.default.createElement(o.default,{className:t.root,maxWidth:"md"},n&&a.default.createElement(i.default,{component:"div",className:t.text,color:"textSecondary",variant:"overline"},"v.",n),a.default.createElement("img",{className:t.logo,alt:"footer",src:"/cc-watermarks-riverscapes_orig.png"}))}},631:function(e,n,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,n,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return n[t]}})}:function(e,n,t,r){void 0===r&&(r=t),e[r]=n[t]}),a=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)"default"!==t&&Object.hasOwnProperty.call(e,t)&&r(n,e,t);return a(n,e),n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.isDisabled=void 0;var c=o(t(0)),s=i(t(90)),l=i(t(205)),u=i(t(169)),d=i(t(153)),p=i(t(238)),m=i(t(633)),g=i(t(634)),h=i(t(91)),f=i(t(635)),j=t(29),b=t(33),O=t(98),v=i(t(723)),y=b.makeStyles(v.default);function x(e){return(!e.meta||!e.meta.access||"PUBLIC"!==e.meta.access)&&null===e.role}n.isDisabled=x;n.default=function(e){var n=e.title,t=e.program,r=e.programs,a=e.signOutHandler,o=e.history,i=y(),b=c.useState(null),v=b[0],S=b[1],w=function(){return S(null)},P=o&&o.location.pathname.indexOf("/admin")>-1,T=(a||r)&&c.default.createElement(p.default,{anchorEl:v,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:!!v,onClose:w},r&&c.default.createElement(d.default,null,c.default.createElement(O.Typography,{variant:"overline",onClick:function(){return o.push("/")}},"Programs")),r&&c.default.createElement(u.default,null),r&&r.length>0&&r.map((function(e,n){return c.default.createElement(d.default,{disabled:t&&t.machineName===e.machineName||x(e),key:"prog-"+n,onClick:function(){return n=e,w(),void(o&&o.push("/"+n.machineName));var n},value:e.machineName},e.name)})),a&&c.default.createElement(u.default,null),a&&c.default.createElement(d.default,{onClick:a},"Log Out")),N=t&&(t.role===j.WarehouseRoleEnum.Admin||t.role===j.WarehouseRoleEnum.SuperUser);return c.default.createElement(c.default.Fragment,null,c.default.createElement(l.default,{position:"static"},c.default.createElement(s.default,{className:i.root,disableGutters:!0},c.default.createElement("a",{href:"http://riverscapes.xyz/"},c.default.createElement("img",{className:i.logo,src:"https://riverscapes.xyz/assets/images/RiverscapesLogo.png",alt:"logo"})),t?c.default.createElement("div",null,c.default.createElement(O.Typography,{variant:"subtitle1"},t.name),c.default.createElement(O.Typography,{variant:"caption"},n)):c.default.createElement(O.Typography,{variant:"subtitle1"},n),c.default.createElement("div",{className:i.spacer}),N&&c.default.createElement(h.default,{"aria-haspopup":"true",onClick:function(){o&&(P?o.push("/"+t.machineName):o.push("/"+t.machineName+"/admin"))},color:"inherit"},P?c.default.createElement(g.default,null):c.default.createElement(m.default,null)),(a||r)&&c.default.createElement(h.default,{"aria-haspopup":"true",onClick:function(e){return S(e.currentTarget)},color:"inherit"},c.default.createElement(f.default,null)))),T)}},636:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{s(r.next(e))}catch(n){o(n)}}function c(e){try{s(r.throw(e))}catch(n){o(n)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,c)}s((r=r.apply(e,n||[])).next())}))},o=this&&this.__generator||function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(c){o=[6,c],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},i=this&&this.__rest||function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.verifyMeta=n.augmentXML=n.parseProjectXML=n.parseProgramXML=n.getXML=void 0;var s=t(637),l=c(t(134)),u=t(217),d=t(29),p=c(t(714));function m(e){return e.reduce((function(e,n){var t,a=n.val,o=n.attr.name;return r(r({},e),((t={})[o]=a&&a.trim(),t))}),{})}n.getXML=function(e){return a(this,void 0,void 0,(function(){var n;return o(this,(function(t){switch(t.label){case 0:return[4,l.default({url:e,method:"get"})];case 1:if(!(n=t.sent()).data)throw new Error("Error retrieving XML file");return[2,n.data]}}))}))},n.parseProgramXML=function(e){return a(this,void 0,void 0,(function(){var n,t,a,c,l,g,h,f,j,b,O,v;return o(this,(function(o){switch(o.label){case 0:return[4,s.parseStringPromise(e).catch((function(e){throw new d.ValidationError("Error parsing XML file. This likely means a broken or unclosed tag.",[e.message])}))];case 1:return n=o.sent(),t=u.util.arrToObj(n),a=t.Program,c=m(a.MetaData),l=c.projectFile,g=c.projectXSDs,h=i(c,["projectFile","projectXSDs"]),f=a.Definitions[0].Collections.map((function(e){var n=e.attr,t=e.Allow,a=e.AllowRegex;return r(r({},n),{Allow:t?Array.isArray(t)?t.map((function(e){return e.attr})):[t]:void 0,AllowRegex:a?Array.isArray(a)?a.map((function(e){return e.attr.pattern})):[a.pattern]:void 0})})),j=[],a.Definitions[0].Groups&&(j=Array.isArray(a.Definitions[0].Groups)?a.Definitions[0].Groups.map((function(e){return e.attr})):[a.Definitions[0].Groups]),b=[],a.Definitions[0].Products&&(b=Array.isArray(a.Definitions[0].Products)?a.Definitions[0].Products.map((function(e){return e.attr})):[a.Definitions[0].Products]),O=(new p.default.DOMParser).parseFromString(e),v=function(e,n,t,a){var o=e.getElementsByTagName("Hierarchy")[0],i=Array.from(o.getElementsByTagName("Product")),c=[];return i.forEach((function(e){var o=[],i=e.getAttribute("ref"),s=n.find((function(e){return e.id===i}));if(!s)throw new Error("Product not found for ref='"+i+"'");for(var l=e.parentNode,u=function(){var e=l.getAttribute("ref"),n=l.tagName,r="Group"===n?t.find((function(n){return n.id===e})):a.find((function(n){return n.id===e})),i=r.folder,c=r.name;o.push({type:n,id:e,folder:i,name:c}),l=l.parentNode};l&&l.parentNode&&"Hierarchy"!==l.tagName;)u();c.push(r(r({},s),{pathArr:o.reverse()}))})),c}(O,b,j,f),[2,Promise.resolve(new d.Program({name:a.Name,machineName:a.MachineName,projectXSDs:g,projectFile:l,meta:h,products:v,collections:f,groups:j}))]}}))}))},n.parseProjectXML=function(e){return a(this,void 0,void 0,(function(){var n,t,r,a,i;return o(this,(function(o){switch(o.label){case 0:return[4,s.parseStringPromise(e).catch((function(e){throw new d.ValidationError("Error parsing XML file. This likely means a broken or unclosed tag.",[e.message])}))];case 1:return n=o.sent(),t=u.util.arrToObj(n),r=t.Project,a={},r.Warehouse&&(a=m(r.Warehouse)),i={},r.MetaData&&(i=m(r.MetaData)),[2,Promise.resolve({id:a.id,name:r.Name,projType:r.ProjectType,Warehouse:a,program:a.program,meta:i,tags:d.Project.parseTagString(a.tags),rawXML:e})]}}))}))},n.augmentXML=function(e,n){var t=(new p.default.DOMParser).parseFromString(n),r=t.getElementsByTagName("MetaData")[0];t.getElementsByTagName("Warehouse").length>0&&t.removeChild(t.getElementsByTagName("Warehouse")[0]);var a=t.createElement("Warehouse");return Object.keys(e).forEach((function(n){var r=t.createElement("Meta");r.setAttribute("name",n),r.appendChild(t.createTextNode(e[n])),a.appendChild(r)})),t.insertBefore(a,r),(new p.default.XMLSerializer).serializeToString(t)},n.verifyMeta=function(e,n,t){var r=t.products.find((function(n){return n.id===e}));if(!r)throw new Error("No project type '"+e+"' found in program '"+t.name+"'");return r.pathArr.filter((function(e){return"Collection"===e.type})).map((function(e){return{name:e.name,value:n[e.name]}}))}},651:function(e,n){},653:function(e,n){},716:function(e,n,t){"use strict";var r=this&&this.__makeTemplateObject||function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e},a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{s(r.next(e))}catch(n){o(n)}}function c(e){try{s(r.throw(e))}catch(n){o(n)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,c)}s((r=r.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(c){o=[6,c],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.adminGetUsers=n.adminUpdateUserPermissions=n.search=n.deleteProject=n.downloadZipFile=n.downloadFile=n.getUploadUrls=n.getProject=n.getProgram=n.getPrograms=n.validateProjectXML=n.authCheck=n.apiCall=void 0;var s,l,u,d,p,m,g,h,f,j,b,O,v=c(t(134)),y=t(912),x=c(t(474)),S=c(t(18)),w=t(29);n.apiCall=function(e,n,t,r){return v.default({url:e,method:"post",headers:n?{Authorization:"Bearer "+n}:null,data:{query:y.print(t),variables:r}}).then((function(e){return e.data})).catch((function(a){throw a.response&&404===a.response.status?new Error("API Url not found: "+e):a.code&&"ECONNREFUSED"===a.code?new Error("Connection refused. Could not contact: '"+e+"'"):(S.default.error("apiCall Error",{url:e,jwt:n,query:y.print(t),variables:r,err:a}),a)}))},n.authCheck=function(e,t){return n.apiCall(e,t,x.default(s||(s=r(["\n            query AuthCall {\n                auth {\n                    loggedIn\n                    userPool\n                    clientId\n                    region\n                    domain\n                }\n            }\n        "],["\n            query AuthCall {\n                auth {\n                    loggedIn\n                    userPool\n                    clientId\n                    region\n                    domain\n                }\n            }\n        "]))),{})},n.validateProjectXML=function(e,t,a,o,i){return n.apiCall(e,t,x.default(l||(l=r(["\n            query validateProject($xml: String!, $projType: String!, $program: String!) {\n                validate(xml: $xml, projType: $projType, program: $program) {\n                    result\n                    xmlErrors\n                }\n            }\n        "],["\n            query validateProject($xml: String!, $projType: String!, $program: String!) {\n                validate(xml: $xml, projType: $projType, program: $program) {\n                    result\n                    xmlErrors\n                }\n            }\n        "]))),{xml:a,program:i,projType:o})},n.getPrograms=function(e,t){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,n.apiCall(e,t,x.default(u||(u=r(["\n            query programs {\n                programs {\n                    name\n                    machineName\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "],["\n            query programs {\n                programs {\n                    name\n                    machineName\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "])))).then((function(e){return a(a({},e),{data:{programs:e.data.programs.map(w.Program.fromGraphQL)}})}))]}))}))},n.getProgram=function(e,t,a){return o(this,void 0,void 0,(function(){var o,c,s;return i(this,(function(i){switch(i.label){case 0:return[4,n.apiCall(e,t,x.default(d||(d=r(["\n            query program($program: String!) {\n                program(program: $program) {\n                    name\n                    machineName\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "],["\n            query program($program: String!) {\n                program(program: $program) {\n                    name\n                    machineName\n                    projectXSDs\n                    projectFile\n                    role\n                    groups {\n                        id\n                        name\n                        folder\n                    }\n                    collections {\n                        id\n                        name\n                        AllowRegex\n                        Allow {\n                            id\n                            name\n                            aliases\n                            folder\n                        }\n                    }\n                    products {\n                        id\n                        name\n                        folder\n                        pathArr\n                    }\n                    hierarchy\n                    meta\n                }\n            }\n        "]))),{program:a})];case 1:return o=i.sent(),c=o.data.program,s=o.errors,[2,{data:{program:w.Program.fromGraphQL(c)},errors:s}]}}))}))},n.getProject=function(e,t,c,s){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,n.apiCall(e,t,x.default(p||(p=r(["\n            query getProject($id: ID!, $program: String!) {\n                project(id: $id, program: $program) {\n                    id\n                    name\n                    projType\n                    totalSize\n                    program\n                    tags\n                    createdBy\n                    updatedBy\n                    createdOn\n                    updatedOn\n                    meta\n                    files {\n                        key\n                        md5\n                        size\n                        downloadUrl\n                    }\n                }\n            }\n        "],["\n            query getProject($id: ID!, $program: String!) {\n                project(id: $id, program: $program) {\n                    id\n                    name\n                    projType\n                    totalSize\n                    program\n                    tags\n                    createdBy\n                    updatedBy\n                    createdOn\n                    updatedOn\n                    meta\n                    files {\n                        key\n                        md5\n                        size\n                        downloadUrl\n                    }\n                }\n            }\n        "]))),{id:c,program:s}).then((function(e){return a(a({},e),{data:{project:w.Project.fromGraphQL(e.data.project)}})}))]}))}))},n.getUploadUrls=function(e,t,a,c,s,l){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,n.apiCall(e,t,x.default(m||(m=r(["\n            query requestUploadProject($id: ID, $files: [String!], $program: String!, $projectType: String!) {\n                requestUpload(id: $id, files: $files, program: $program, projectType: $projectType) {\n                    id\n                    uploadUrls {\n                        url\n                        fields\n                        origPath\n                    }\n                }\n            }\n        "],["\n            query requestUploadProject($id: ID, $files: [String!], $program: String!, $projectType: String!) {\n                requestUpload(id: $id, files: $files, program: $program, projectType: $projectType) {\n                    id\n                    uploadUrls {\n                        url\n                        fields\n                        origPath\n                    }\n                }\n            }\n        "]))),{id:a,files:c,projectType:s,program:l})];case 1:return[2,o.sent()]}}))}))},n.downloadFile=function(e,t,a,c,s,l){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,n.apiCall(e,t,x.default(g||(g=r(["\n            query downloadFileQuery($program: String!, $id: ID!, $projType: String!, $filePath: String!) {\n                downloadFile(program: $program, id: $id, projType: $projType, filePath: $filePath) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                }\n            }\n        "],["\n            query downloadFileQuery($program: String!, $id: ID!, $projType: String!, $filePath: String!) {\n                downloadFile(program: $program, id: $id, projType: $projType, filePath: $filePath) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                }\n            }\n        "]))),{projType:a,program:c,id:s,filePath:l})];case 1:return[2,o.sent()]}}))}))},n.downloadZipFile=function(e,t,a,c,s){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,n.apiCall(e,t,x.default(h||(h=r(["\n            query downloadZipFileQuery($program: String!, $id: ID!, $projType: String!) {\n                downloadZip(program: $program, id: $id, projType: $projType) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                    pendingSince\n                }\n            }\n        "],["\n            query downloadZipFileQuery($program: String!, $id: ID!, $projType: String!) {\n                downloadZip(program: $program, id: $id, projType: $projType) {\n                    key\n                    md5\n                    contentType\n                    size\n                    downloadUrl\n                    pendingSince\n                }\n            }\n        "]))),{projType:a,program:c,id:s})];case 1:return[2,o.sent()]}}))}))},n.deleteProject=function(e,t,a,c){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,n.apiCall(e,t,x.default(f||(f=r(["\n            mutation deleteProject($id: ID!, $program: String!) {\n                deleteProject(id: $id, program: $program)\n            }\n        "],["\n            mutation deleteProject($id: ID!, $program: String!) {\n                deleteProject(id: $id, program: $program)\n            }\n        "]))),{program:c,id:a})];case 1:return[2,o.sent()]}}))}))},n.search=function(e,t,c,s){return o(this,void 0,void 0,(function(){var o,l,u,d,p;return i(this,(function(i){switch(i.label){case 0:return[4,n.apiCall(e,t,x.default(j||(j=r(["\n            query searchQuery(\n                $program: String!\n                $projType: String\n                $nameStr: String\n                $metaStr: String\n                $metaArr: String\n                $tags: String\n                $noTags: Boolean\n                $limit: Int\n                $nextToken: Int\n            ) {\n                search(\n                    program: $program\n                    projType: $projType\n                    nameStr: $nameStr\n                    metaStr: $metaStr\n                    metaArr: $metaArr\n                    tags: $tags\n                    noTags: $noTags\n                    limit: $limit\n                    nextToken: $nextToken\n                ) {\n                    projects {\n                        id\n                        name\n                        projType\n                        program\n                        tags\n                        totalSize\n                        createdBy\n                        updatedBy\n                        createdOn\n                        updatedOn\n                        meta\n                        score\n                    }\n                    nextToken\n                    total\n                }\n            }\n        "],["\n            query searchQuery(\n                $program: String!\n                $projType: String\n                $nameStr: String\n                $metaStr: String\n                $metaArr: String\n                $tags: String\n                $noTags: Boolean\n                $limit: Int\n                $nextToken: Int\n            ) {\n                search(\n                    program: $program\n                    projType: $projType\n                    nameStr: $nameStr\n                    metaStr: $metaStr\n                    metaArr: $metaArr\n                    tags: $tags\n                    noTags: $noTags\n                    limit: $limit\n                    nextToken: $nextToken\n                ) {\n                    projects {\n                        id\n                        name\n                        projType\n                        program\n                        tags\n                        totalSize\n                        createdBy\n                        updatedBy\n                        createdOn\n                        updatedOn\n                        meta\n                        score\n                    }\n                    nextToken\n                    total\n                }\n            }\n        "]))),a(a({},s),{program:c}))];case 1:return(o=i.sent()).data?(l=o.data.search||{},u=l.nextToken,d=l.projects,p=l.total,[2,{errors:o.errors,data:{search:{projects:Array.isArray(d)?d.map(w.Project.fromGraphQL):d,nextToken:u,total:p}}}]):[2,{errors:o.errors}]}}))}))},n.adminUpdateUserPermissions=function(e,t,c,s,l){return o(this,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return[4,n.apiCall(e,t,x.default(b||(b=r(["\n            mutation project($id: ID!, $program: String!, $permission: String) {\n                updateUser(id: $id, program: $program, permission: $permission) {\n                    email\n                    name\n                    picture\n                    username\n                    createdOn\n                    updatedOn\n                    role\n                }\n            }\n        "],["\n            mutation project($id: ID!, $program: String!, $permission: String) {\n                updateUser(id: $id, program: $program, permission: $permission) {\n                    email\n                    name\n                    picture\n                    username\n                    createdOn\n                    updatedOn\n                    role\n                }\n            }\n        "]))),{program:s,id:c,permission:l})];case 1:return(o=i.sent()).data?[2,{errors:o.errors,data:{updateUser:o.data.updateUser?a(a({},o.data.updateUser),{createdOn:parseInt(o.data.updateUser.createdOn,10),updatedOn:parseInt(o.data.updateUser.updatedOn,10)}):null}}]:[2,{errors:o.errors}]}}))}))},n.adminGetUsers=function(e,t,c,s,l){return o(this,void 0,void 0,(function(){var o,u,d,p;return i(this,(function(i){switch(i.label){case 0:return[4,n.apiCall(e,t,x.default(O||(O=r(["\n            query getUsers($program: String!, $limit: Int, $nextToken: String) {\n                getUsers(program: $program, limit: $limit, nextToken: $nextToken) {\n                    users {\n                        email\n                        name\n                        picture\n                        username\n                        createdOn\n                        updatedOn\n                        role\n                    }\n                    nextToken\n                }\n            }\n        "],["\n            query getUsers($program: String!, $limit: Int, $nextToken: String) {\n                getUsers(program: $program, limit: $limit, nextToken: $nextToken) {\n                    users {\n                        email\n                        name\n                        picture\n                        username\n                        createdOn\n                        updatedOn\n                        role\n                    }\n                    nextToken\n                }\n            }\n        "]))),{program:c,limit:s,nextToken:l})];case 1:return(o=i.sent()).data?(u=o.data.getUsers||{},d=u.nextToken,p=u.users,[2,{errors:o.errors,data:{getUsers:{users:Array.isArray(p)?p.map((function(e){return a(a({},e),{createdOn:parseInt(e.createdOn,10),updatedOn:parseInt(e.updatedOn,10)})})):p,nextToken:d}}}]):[2,{errors:o.errors}]}}))}))}},717:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AccessEnum=n.WarehouseRoleEnum=n.FieldTypeEnum=void 0,function(e){e.string="S",e.number="N",e.boolean="BOOL",e.stringArr="SARR",e.numberArr="NARR"}(n.FieldTypeEnum||(n.FieldTypeEnum={})),function(e){e.SuperUser="SUPER",e.Admin="ADMIN",e.Observer="OBSERVER",e.Participant="PARTICIPANT"}(n.WarehouseRoleEnum||(n.WarehouseRoleEnum={})),function(e){e.Public="PUBLIC",e.Private="PRIVATE",e.Secret="SECRET"}(n.AccessEnum||(n.AccessEnum={}))},718:function(e,n,t){"use strict";var r=this&&this.__makeTemplateObject||function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o,i=a(t(474)).default(o||(o=r(["\n    # Check out the cheat sheet:\n    # https://raw.githubusercontent.com/sogko/graphql-shorthand-notation-cheat-sheet/master/graphql-shorthand-notation-cheat-sheet.png\n\n    schema {\n        query: Query\n        mutation: Mutation\n    }\n\n    type Query {\n        # Get a project and associated metadata\n        auth: AuthParams\n\n        project(id: ID!, program: String!): Project\n        projects(program: String!, projType: String, limit: Int, nextToken: String): PaginatedProjects\n\n        program(program: String!): Program\n        programs: [Program]\n\n        downloadFile(program: String!, id: ID!, projType: String!, filePath: String!): FileDownloadMeta\n\n        downloadZip(program: String!, id: ID!, projType: String!): FileDownloadMeta\n\n        # Request an upload start. Writes a manifest file on the upload bucket\n        # and creates upload urls for everything\n        requestUpload(id: ID, files: [String!], program: String!, projectType: String!): FileUpload\n\n        search(\n            program: String!\n            projType: String\n            nameStr: String\n            metaStr: String\n            metaArr: String\n            tags: String\n            noTags: Boolean\n            limit: Int\n            nextToken: Int\n        ): PaginatedSearchResults\n\n        validate(xml: String!, projType: String!, program: String!): Validation\n\n        getUsers(program: String!, limit: Int, nextToken: String): PaginatedUsers\n    }\n\n    # this schema allows the following mutation:\n    type Mutation {\n        # signal a deletion of a project\n        deleteProject(id: ID!, program: String!): ID!\n        updateUser(id: ID!, program: String!, permission: String): User\n    }\n\n    type User {\n        email: String\n        name: String\n        picture: String\n        username: String!\n        createdOn: String\n        updatedOn: String\n        role: String\n    }\n\n    type PaginatedUsers {\n        users: [User]\n        nextToken: String\n    }\n\n    type Validation {\n        result: Boolean\n        xmlErrors: [String]\n    }\n\n    type AuthParams {\n        loggedIn: Boolean\n        userPool: String\n        clientId: String\n        region: String\n        domain: String\n    }\n\n    interface ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n    }\n\n    type Project implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        files: [FileDownloadMeta]\n    }\n\n    type ProjectSearchResult implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        score: Float\n        files: [FileDownloadMeta]\n    }\n\n    # This is mostly just JSON that's stringified\n    type Product {\n        id: ID!\n        name: String!\n        folder: String\n        # Stringified JSON Array:\n        pathArr: String\n    }\n    type Group {\n        id: ID!\n        name: String!\n        folder: String\n    }\n    type NamedAllow {\n        id: ID!\n        name: String!\n        aliases: String\n        folder: String\n    }\n    type Collection {\n        id: ID!\n        name: String!\n        AllowRegex: [String]\n        Allow: [NamedAllow]\n    }\n    type Program {\n        name: String\n        machineName: String\n        projectXSDs: String\n        projectFile: String\n        meta: String\n        groups: [Group]\n        collections: [Collection]\n        products: [Product]\n        hierarchy: String\n        role: String\n    }\n\n    type FileDownloadMeta {\n        key: String!\n        md5: String!\n        size: String\n        contentType: String\n        downloadUrl: String!\n        pendingSince: String\n    }\n\n    type FileUpload {\n        id: ID!\n        uploadUrls: [UploadUrl]\n    }\n\n    type UploadUrl {\n        url: String\n        fields: String\n        origPath: String\n    }\n\n    type FileUploadMeta {\n        key: String!\n        downloadUrl: String!\n    }\n\n    # Series Connection allows us to implement pagination easily\n    type PaginatedProjects {\n        projects: [Project]\n        nextToken: String\n    }\n\n    type PaginatedSearchResults {\n        projects: [ProjectSearchResult]\n        nextToken: Int\n        total: Int\n    }\n\n    type NewProject {\n        id: ID!\n    }\n"],["\n    # Check out the cheat sheet:\n    # https://raw.githubusercontent.com/sogko/graphql-shorthand-notation-cheat-sheet/master/graphql-shorthand-notation-cheat-sheet.png\n\n    schema {\n        query: Query\n        mutation: Mutation\n    }\n\n    type Query {\n        # Get a project and associated metadata\n        auth: AuthParams\n\n        project(id: ID!, program: String!): Project\n        projects(program: String!, projType: String, limit: Int, nextToken: String): PaginatedProjects\n\n        program(program: String!): Program\n        programs: [Program]\n\n        downloadFile(program: String!, id: ID!, projType: String!, filePath: String!): FileDownloadMeta\n\n        downloadZip(program: String!, id: ID!, projType: String!): FileDownloadMeta\n\n        # Request an upload start. Writes a manifest file on the upload bucket\n        # and creates upload urls for everything\n        requestUpload(id: ID, files: [String!], program: String!, projectType: String!): FileUpload\n\n        search(\n            program: String!\n            projType: String\n            nameStr: String\n            metaStr: String\n            metaArr: String\n            tags: String\n            noTags: Boolean\n            limit: Int\n            nextToken: Int\n        ): PaginatedSearchResults\n\n        validate(xml: String!, projType: String!, program: String!): Validation\n\n        getUsers(program: String!, limit: Int, nextToken: String): PaginatedUsers\n    }\n\n    # this schema allows the following mutation:\n    type Mutation {\n        # signal a deletion of a project\n        deleteProject(id: ID!, program: String!): ID!\n        updateUser(id: ID!, program: String!, permission: String): User\n    }\n\n    type User {\n        email: String\n        name: String\n        picture: String\n        username: String!\n        createdOn: String\n        updatedOn: String\n        role: String\n    }\n\n    type PaginatedUsers {\n        users: [User]\n        nextToken: String\n    }\n\n    type Validation {\n        result: Boolean\n        xmlErrors: [String]\n    }\n\n    type AuthParams {\n        loggedIn: Boolean\n        userPool: String\n        clientId: String\n        region: String\n        domain: String\n    }\n\n    interface ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n    }\n\n    type Project implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        files: [FileDownloadMeta]\n    }\n\n    type ProjectSearchResult implements ProjectBase {\n        id: ID!\n        name: String\n        meta: String\n        tags: String\n        projType: String\n        totalSize: String\n        program: String\n        createdBy: ID!\n        updatedBy: ID!\n        createdOn: String!\n        updatedOn: String!\n        score: Float\n        files: [FileDownloadMeta]\n    }\n\n    # This is mostly just JSON that's stringified\n    type Product {\n        id: ID!\n        name: String!\n        folder: String\n        # Stringified JSON Array:\n        pathArr: String\n    }\n    type Group {\n        id: ID!\n        name: String!\n        folder: String\n    }\n    type NamedAllow {\n        id: ID!\n        name: String!\n        aliases: String\n        folder: String\n    }\n    type Collection {\n        id: ID!\n        name: String!\n        AllowRegex: [String]\n        Allow: [NamedAllow]\n    }\n    type Program {\n        name: String\n        machineName: String\n        projectXSDs: String\n        projectFile: String\n        meta: String\n        groups: [Group]\n        collections: [Collection]\n        products: [Product]\n        hierarchy: String\n        role: String\n    }\n\n    type FileDownloadMeta {\n        key: String!\n        md5: String!\n        size: String\n        contentType: String\n        downloadUrl: String!\n        pendingSince: String\n    }\n\n    type FileUpload {\n        id: ID!\n        uploadUrls: [UploadUrl]\n    }\n\n    type UploadUrl {\n        url: String\n        fields: String\n        origPath: String\n    }\n\n    type FileUploadMeta {\n        key: String!\n        downloadUrl: String!\n    }\n\n    # Series Connection allows us to implement pagination easily\n    type PaginatedProjects {\n        projects: [Project]\n        nextToken: String\n    }\n\n    type PaginatedSearchResults {\n        projects: [ProjectSearchResult]\n        nextToken: Int\n        total: Int\n    }\n\n    type NewProject {\n        id: ID!\n    }\n"])));n.default=i},719:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.Program=void 0;var a=function(){function e(e){Object.assign(this,e)}return e.fromGraphQL=function(n){if(!n)return null;var t=JSON.parse(n.meta);return new e(r(r({},n),{meta:t,role:n.role,products:n.products.map((function(e){return r(r({},e),{pathArr:JSON.parse(e.pathArr)})}))}))},e}();n.Program=a},720:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Project=void 0;var o=a(t(721));function i(e){e.sort((function(e,n){return e.children&&!n.children?-1:!e.children&&n.children?1:e.name.toLowerCase()<n.name.toLowerCase()?-1:e.name.toLowerCase()>n.name.toLowerCase()?1:0}))}var c=function(){function e(e){var n=this;this.treeIzeFilePaths=function(){var e=[];return n.files.forEach((function(n){var t=n.key,r=t.split("/");1===r.length&&t.indexOf("\\")>-1&&(r=t.split("\\"));for(var a=e,o=function(){var e={name:r.shift(),children:[]},n=a.find((function(n){return n.name===e.name}));n&&n.children?a=n.children:(a.push(e),a=e.children),i(a)};r.length>1;)o();a.push({name:r[0],path:t})})),i(e),e},Object.assign(this,e)}return e.fromGraphQL=function(n){return n?new e(r(r({},n),{meta:n.meta?JSON.parse(n.meta):{},tags:n.tags?n.tags.split(","):[]})):null},e.diff=function(e,n){var t=[],r=[];return n&&0!==n.length?e&&0!==e.length?{leftOnly:e.filter((function(e){var a=n.find((function(n){return e.key===n.key}));return a&&(a.md5===e.md5?r.push(e.key):t.push(e.key)),!a})).map((function(e){return e.key})),rightOnly:n.filter((function(n){return!e.find((function(e){return n.key===e.key}))})).map((function(e){return e.key})),different:t,same:r}:{leftOnly:[],rightOnly:n.map((function(e){return e.key})),different:[],same:[]}:{leftOnly:e.map((function(e){return e.key})),rightOnly:[],different:[],same:[]}},e.getProjectS3Keys=function(e,n,t){var r=o.default.join(e.machineName,t,n),a=r+".zip",i=o.default.join(r,e.projectFile),c=o.default.join(e.machineName,t,n+".zip.pending"),s=""+[e.machineName,t,n].join("-");return{prefix:r,zipKey:a,projFileKey:i,zipKeyPending:c,downloadFolderName:s,downloadZipFilename:s+".zip"}},e.parseDynamoMeta=function(e){var n=Object.keys(e).filter((function(e){return 0===e.indexOf("META_")})).reduce((function(n,t){var a,o=t.split("META_")[1];return r(r({},n),((a={})[o]=e[t],a))}),{});return JSON.stringify(n)},e.parseTagString=function(e){return e&&0!==e.trim().length?e.split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0&&"null"!==e&&"undefined"!==e})):[]},e.parseS3Key=function(n,t){if(t.split("/").length<3)throw new Error("Not a valid project key");var r=t.split("/"),a=r[0],o=r[1],i=r[2];if(n.machineName!==a)throw new Error("Program passed to parseS3 key "+n.machineName+" does not correspond to program in key: "+a);return e.getProjectS3Keys(n,i,o)},e.parseS3KeyDUMB=function(e){var n=e.split("/");if(n.length<3)throw new Error("Not a valid project key");var t=n[0],r=n[1],a=n[2],i=o.default.join(t,r,a);return{programMachineName:t,projType:r,id:a,zipKey:i+".zip",prefix:i}},e}();n.Project=c},722:function(e,n,t){"use strict";var r=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.ValidationError=void 0;var a=function(e){function n(n,t){var r=e.call(this,n)||this;return r.name=r.constructor.name,r.reasons=t,Error.captureStackTrace(r,r.constructor),r}return r(n,e),n}(Error);n.ValidationError=a},723:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(33);n.default=function(e){var n,t,a,o;return{root:{display:"flex",alignItems:"center",width:"100%",padding:e.spacing(0,1),textShadow:"3px 3px 3px rgba(0,0,0,0.7)",backgroundImage:"url(/HeaderBackground.png)",backgroundRepeat:"no-repeat",backgroundPosition:"0% 50%",backgroundSize:"cover",backgroundColor:"#444444"},logo:{height:40,width:40,marginRight:e.spacing(2)},programChooser:{margin:e.spacing(0,1),color:e.palette.primary.contrastText,"& svg":{color:e.palette.primary.contrastText},"&:before":{borderColor:e.palette.primary.contrastText},"&:after":{borderColor:e.palette.primary.contrastText}},transparent:{backgroundColor:"transparent",background:"none",color:e.palette.text.primary},search:(n={position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:r.fade(e.palette.common.white,.15),"&:hover":{backgroundColor:r.fade(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%",flexGrow:1},n[e.breakpoints.up("sm")]={marginLeft:e.spacing(3),width:"auto"},n),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},spacer:{flexGrow:1},inputInput:(t={padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},t[e.breakpoints.up("sm")]={width:200},t),sectionDesktop:(a={display:"none"},a[e.breakpoints.up("sm")]={display:"flex",flexGrow:1},a),sectionMobile:(o={display:"flex",flexGrow:1},o[e.breakpoints.up("sm")]={display:"none"},o)}}},724:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=a(t(0)),i=t(98),c=a(t(37)),s=a(t(140)),l=t(33).makeStyles((function(e){return{root:{marginLeft:e.spacing(1)/2},tooltip:{maxWidth:220}}}));n.default=function(e){var n=e.tags,t=e.chipProps,a=l();return o.default.createElement(o.default.Fragment,null,n.map((function(e,n){return o.default.createElement(s.default,{key:"whTag-"+n,title:o.default.createElement(o.default.Fragment,null,o.default.createElement(c.default,{variant:"body1"},"Warehouse Tag: ",e),o.default.createElement(c.default,{variant:"caption"},"Warehouse tags can be added to delineate two identical projects in the warehouse"))},o.default.createElement(i.Chip,r({label:e},t,{className:a.root})))})))}},725:function(e,n,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.isDisabled=void 0;var o=a(t(0)),i=a(t(61)),c=a(t(171)),s=a(t(37)),l=a(t(155)),u=a(t(245)),d=a(t(141)),p=a(t(208)),m=a(t(156)),g=a(t(366)),h=t(33),f=a(t(4)),j=t(482),b=h.makeStyles((function(e){return{rootContainer:{height:"100%",display:"flex",flexDirection:"column"},spacer:{flexGrow:1},root:{padding:e.spacing(2,4,4,4)},logoContainer:{padding:e.spacing(2),textAlign:"center"},logo:{},accessChip:r({},Object.keys(j.accessColors).reduce((function(n,t){var a;return r(r({},n),((a={})["&.access_"+t]={color:e.palette.getContrastText(j.accessColors[t][500]),background:j.accessColors[t][500]},a))}),{}))}}));function O(e){return(!e.meta||!e.meta.access||"PUBLIC"!==e.meta.access)&&null===e.role}n.isDisabled=O;n.default=function(e){var n=e.programs,t=e.history,r=e.navigate,a=b();return o.default.createElement("div",{className:a.rootContainer},o.default.createElement("div",{className:a.spacer}),o.default.createElement(i.default,{className:a.root,elevation:1},o.default.createElement("div",{className:a.logoContainer},o.default.createElement("img",{className:a.logo,src:"/RiverscapesLogo.png",alt:"logo"})),o.default.createElement(s.default,{variant:"h5"},"Choose a program:"),o.default.createElement(l.default,null,n&&n.map((function(e,n){var i=o.default.createElement(u.default,{icon:o.default.createElement(g.default,null),className:f.default(a.accessChip,"access_"+e.role),label:e.role||"Observer",color:"primary"}),s=O(e);return s&&(i=o.default.createElement(u.default,{label:"No Access",color:"default"})),o.default.createElement(d.default,{key:"progKey-"+n,disabled:s,button:!0,divider:!0,onClick:function(){return r(t,e)}},o.default.createElement(m.default,null,o.default.createElement(c.default,{alt:"programname"},e.name.substr(0,1))),o.default.createElement(p.default,{primary:e.name,secondary:e.meta.description}),i)}))),o.default.createElement(s.default,{paragraph:!0,variant:"caption"},"If there are programs labeled"," ",o.default.createElement(u.default,{label:"No Access",component:"span",color:"default",size:"small"})," and you think you should be able to see them please contact your program administrator.")),o.default.createElement("div",{className:a.spacer}))}},730:function(e,n){},732:function(e,n){},760:function(e,n){},761:function(e,n){},766:function(e,n){},768:function(e,n){},775:function(e,n){},794:function(e,n){},910:function(e,n,t){},913:function(e,n,t){"use strict";t.r(n);var r=t(3),a=t(0),o=t.n(a),i=t(34),c=t.n(i),s=t(16),l=t(44),u=t(110),d=t(136),p=t.n(d),m=t(181),g=t(266),h=t.n(g),f=t(18),j=t.n(f),b=t(442),O=t(968),v=t(971),y=t(972),x=t(973),S=t(974),w=t(569),P=t.n(w),T=t(117),N=Object(b.a)((function(e){return{root:{marginLeft:e.spacing(1)},titlebar:{display:"flex",background:e.palette.error.main,color:e.palette.error.contrastText},closeButton:{},name:{paddingLeft:e.spacing(1),flexGrow:1}}})),C=function(e){var n=e.onClose,t=e.program,a=N();return Object(r.jsxs)(O.a,{onClose:n,open:!0,maxWidth:"xs",fullWidth:!0,className:a.root,classes:{},children:[Object(r.jsxs)(v.a,{disableTypography:!0,className:a.titlebar,children:[Object(r.jsx)(P.a,{color:"inherit"}),Object(r.jsx)(T.a,{className:a.name,children:"Access Denied"})]}),Object(r.jsx)(y.a,{dividers:!0,children:t?Object(r.jsx)(T.a,{variant:"body1",component:"div",color:"inherit",children:"You don't have access to the program <strong>{program.name}</strong>. If you arrived here via URL you will be able to use the URL again once you have access."}):Object(r.jsx)(T.a,{variant:"body1",component:"div",color:"inherit",children:"This URL is not valid. If you arrived here via URL you will be able to use the URL again once you have access."})}),Object(r.jsx)(x.a,{children:Object(r.jsx)(S.a,{onClick:n,color:"primary",children:"Back to programs"})})]})},k=t(980),I=t(481),E=t(364),A=t(446),_=t(576),D=t.n(_),R=t(919),$=t(575),U=t.n($),F=t(572),L=t.n(F),M=t(573),W=t.n(M),B=t(574),G=t.n(B),z=t(986),q=t(577),Z=t.n(q),V=t(578),X=t.n(V),K=t(113),Q=t(4),H=t(277),J=t.n(H),Y=t(151),ee=t.n(Y),ne=t(186),te=t(475),re=t(189),ae=t(976),oe=t(278),ie=t.n(oe),ce=Object(b.a)((function(e){return{root:{marginLeft:e.spacing(1)},disabledButton:{opacity:.5}}})),se=function(e){var n=e.title,t=e.project,a=e.pendingSince,i=e.btnProps,c=e.downloadZipFile,l=ce(),u=Object(r.jsx)(I.a,{title:Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(T.a,{variant:"body1",children:"Download Project Zip"}),Object(r.jsx)(T.a,{variant:"caption",paragraph:!0,children:"Click to download this project as a single zip file"}),Object(r.jsx)(T.a,{variant:"caption",paragraph:!0,children:"There may be a delay if the zip file needs to be built."})]}),children:Object(r.jsx)(S.a,Object(s.a)(Object(s.a)({variant:"outlined",color:"primary",onClick:function(e){e.preventDefault(),e.stopPropagation(),c(t)},startIcon:Object(r.jsx)(ie.a,{})},i),{},{children:n||"ZIP"}))});return a&&(u=Object(r.jsx)(I.a,{title:Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(T.a,{variant:"body1",children:"Preparing Zip"}),Object(r.jsx)(T.a,{variant:"caption",paragraph:!0,children:"The warehouse is building your zip file for you."}),Object(r.jsxs)(T.a,{variant:"caption",paragraph:!0,children:["started ",ee()(a,"x").fromNow()]})]}),children:Object(r.jsx)(S.a,Object(s.a)(Object(s.a)({variant:"outlined",disableFocusRipple:!0,disableRipple:!0,disableTouchRipple:!0,color:"primary",onClick:function(e){e.preventDefault(),e.stopPropagation()},className:l.disabledButton,startIcon:Object(r.jsx)(ae.a,{color:"secondary",size:24,thickness:3})},i),{},{children:n||"ZIP"}))})),Object(r.jsx)("div",{className:l.root,children:u})},le=t(985),ue=Object(b.a)((function(e){return{treeItemRoot:{backgroundColor:e.palette.background.paper,"&:nth-child(odd)":{backgroundColor:e.palette.background.default}},treeItemContainer:{display:"flex"},treeItemText:{marginLeft:e.spacing(1),padding:e.spacing(1),flexGrow:1},treeItemIcon:{},treeFile:{},treeFileContent:{borderBottom:"1px solid ".concat(e.palette.grey[100])},treeFolder:{},treeFolderContent:{},treeFolderText:{padding:e.spacing(1)},allowSelect:{"&,& *":{userSelect:"text",cursor:"auto"}}}})),de=function e(n){var t=n.item,a=n.fileDict,i=n.keyStr,c=n.project,s=n.fileClick,l=ue();if(t.children){var u=t.children.map((function(n,t){return Object(r.jsx)(e,{keyStr:"".concat(i,"-l").concat(t),item:n,fileDict:a,project:c,fileClick:s},"".concat(i,"-l").concat(t))}));return Object(r.jsx)(le.a,{nodeId:i,className:l.treeFolder,classes:{content:l.treeFolderContent},label:Object(r.jsx)("div",{className:l.treeFolderText,children:t.name}),children:u})}var d=t.path?a[t.path]:{size:"0"};return Object(r.jsx)(le.a,{nodeId:i,className:l.treeFile,classes:{root:l.treeItemRoot,content:l.treeFileContent},label:Object(r.jsxs)("div",{className:l.treeItemContainer,children:[Object(r.jsxs)("div",{className:l.treeItemText,children:[Object(r.jsx)(T.a,{color:"textPrimary",component:"div",variant:"body1",children:t.name}),Object(r.jsxs)(T.a,{color:"textSecondary",component:"div",variant:"caption",children:[J()(parseInt(d.size,10))," --"," ",Object(r.jsx)("span",{className:l.allowSelect,children:t.path})]})]}),Object(r.jsx)(I.a,{title:Object(r.jsx)(o.a.Fragment,{children:Object(r.jsxs)(T.a,{variant:"body1",children:["Download: ",t.path]})}),children:Object(r.jsx)(E.a,{disableRipple:!0,className:l.treeItemIcon,color:"primary",onClick:function(){return s(c,t.path)},children:Object(r.jsx)(ie.a,{})})})]}),endIcon:d.icon})},pe=Object(b.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},allowSelect:{"&,& *":{userSelect:"text",cursor:"auto"}},scrollPaper:{alignItems:"baseline"},name:{maxWidth:"95%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginBottom:e.spacing(1)},titlebar:{backgroundColor:"#444444",color:e.palette.primary.contrastText},flexGrow:{flexGrow:1},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},normalIcon:{},documentIcon:{color:ne.a[500]},photoIcon:{color:te.a[500]},TerrainIcon:{color:re.a[500]},metaDisplay:{display:"flex",flexFlow:"wrap"},title:{marginTop:e.spacing(2)},treeItemContainer:{display:"flex"},treeItemText:{marginLeft:e.spacing(1),flexGrow:1},treeItemIcon:{},treeFileContent:{borderBottom:"1px solid ".concat(e.palette.grey[100]),padding:e.spacing(1)},treeFolder:{},treeFolderContent:{padding:e.spacing(1)},metaDisplayItem:{flex:"1 1",borderRadius:e.spacing(1),backgroundColor:"#fafafa",margin:e.spacing(1,.5),border:"#1px solid #e7e7e7",padding:e.spacing(1),maxWidth:"25%",minWidth:150,"&>*":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},prodChip:{marginLeft:e.spacing(1),backgroundColor:e.palette.primary.light,color:"white"},popOver:{padding:e.spacing(2)},subHeader:{width:"100%",display:"flex"}}})),me=function(e){var n=e.onClose,t=e.project,i=e.downloadFile,c=e.program,d=e.pendingZips,p=e.downloadZipFile,m=pe(),g=Object(a.useState)(null),h=Object(l.a)(g,2),f=h[0],j=h[1],b=d[t.id],x=[{pattern:/.*\.(png|gif|jpg|jpeg)$/i,icon:Object(r.jsx)(L.a,{className:m.photoIcon}),classStr:"photo"},{pattern:/.*\.(tif|img|shp)$/i,icon:Object(r.jsx)(W.a,{className:m.TerrainIcon}),classStr:"terrain"},{pattern:/.*\.(csv|pdf|doc)$/i,icon:Object(r.jsx)(G.a,{className:m.documentIcon}),classStr:"assignment"}],S=t.files.reduce((function(e,n){var t=x.find((function(e){var t=e.pattern;return n.key.match(t)}));return Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},n.key,Object(s.a)(Object(s.a)({},n),{},{icon:t?t.icon:Object(r.jsx)(U.a,{className:m.normalIcon}),classStr:t?t.classStr:"normalIcon"})))}),{}),w=t.treeIzeFilePaths(),P=c.products.find((function(e){return e.id===t.projType})),N=P?P.name:"Unknown",C=Object.keys(t.meta).find((function(e){return"description"===e.toLowerCase()}));return Object(r.jsxs)(O.a,{onClose:n,open:!0,maxWidth:"md",fullWidth:!0,className:m.root,classes:{scrollPaper:m.scrollPaper},children:[Object(r.jsxs)(v.a,{disableTypography:!0,className:m.titlebar,children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(I.a,{title:Object(r.jsx)(T.a,{variant:"body1",children:t.name}),children:Object(r.jsx)(T.a,{variant:"h5",component:"div",className:Object(Q.default)(m.name,m.allowSelect),children:t.name})}),Object(r.jsxs)("div",{className:m.subHeader,children:[Object(r.jsx)("div",{className:m.flexGrow,children:Object(r.jsxs)(T.a,{variant:"caption",color:"inherit",component:"div",children:["ID: ",Object(r.jsx)("span",{className:m.allowSelect,children:t.id})]})}),Object(r.jsx)(se,Object(s.a)(Object(s.a)({title:"Download Project"},{project:t,pendingSince:b,downloadZipFile:p}),{},{btnProps:{variant:"contained",color:"secondary",size:"small"}}))]})]}),n?Object(r.jsx)(E.a,{"aria-label":"close",className:m.closeButton,onClick:n,children:Object(r.jsx)(D.a,{})}):null]}),Object(r.jsxs)(y.a,{dividers:!0,children:[Object(r.jsxs)("div",{className:m.allowSelect,children:[Object(r.jsxs)(T.a,{variant:"caption",component:"div",color:"inherit",children:[Object(r.jsx)("strong",{children:"Project Type"}),": ",Object(r.jsx)("strong",{children:N})," (",P&&P.id,")"]}),Object(r.jsxs)(T.a,{variant:"caption",component:"div",color:"inherit",children:[Object(r.jsx)("strong",{children:"Created"}),": ",ee()(t.createdOn,"x").fromNow()," (",ee()(t.createdOn,"x").format("lll"),")"]}),Object(r.jsxs)(T.a,{variant:"caption",component:"div",color:"inherit",children:[Object(r.jsx)("strong",{children:"Updated"}),": ",ee()(t.updatedOn,"x").fromNow()," (",ee()(t.updatedOn,"x").format("lll"),")"]}),Object(r.jsxs)(T.a,{variant:"caption",component:"div",color:"inherit",children:[Object(r.jsx)("strong",{children:"Warehouse tags:"}),Object(r.jsx)(K.WarehouseTags,{tags:t.tags,chipProps:{size:"small",color:"secondary"}})]}),Object(r.jsxs)(T.a,{variant:"caption",component:"div",color:"inherit",children:[Object(r.jsx)("strong",{children:"Size (Unzipped)"}),":"," ",t.totalSize&&t.totalSize>-1?J()(t.totalSize):"Not available"]}),C&&Object(r.jsxs)("div",{children:[Object(r.jsx)(T.a,{className:m.title,color:"inherit",component:"div",variant:"subtitle1",children:"Description"}),Object(r.jsx)(T.a,{color:"textSecondary",variant:"body2",children:t.meta[C]})]}),Object(r.jsx)(T.a,{className:m.title,color:"inherit",variant:"subtitle1",children:"Metadata"}),Object(r.jsx)(A.a,{}),Object(r.jsx)("div",{className:m.metaDisplay,children:Object.keys(t.meta).filter((function(e){return-1===["description"].indexOf(e.toLowerCase())})).map((function(e,n){var a=t.meta[e];return 0===t.meta[e].indexOf("http")&&(a=Object(r.jsx)(k.a,{href:t.meta[e],target:"_blank",children:t.meta[e]})),Object(r.jsx)(I.a,{placement:"bottom",title:Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(T.a,{variant:"body1",component:"div",children:Object(r.jsx)("strong",{children:e})}),Object(r.jsx)(T.a,{variant:"body2",component:"div",children:a})]}),children:Object(r.jsxs)("div",{className:m.metaDisplayItem,children:[Object(r.jsx)(T.a,{variant:"caption",component:"div",color:"textPrimary",children:Object(r.jsx)("strong",{children:e})}),Object(r.jsx)(T.a,{variant:"caption",component:"div",color:"textPrimary",children:a})]})},"result-".concat(n))}))})]}),Object(r.jsx)(T.a,{className:m.title,color:"inherit",variant:"subtitle1",children:"Files"}),Object(r.jsx)(A.a,{}),Object(r.jsx)(z.a,{className:m.treeRoot,defaultExpanded:["1"],disableSelection:!0,defaultCollapseIcon:Object(r.jsx)(Z.a,{color:"inherit"}),defaultExpandIcon:Object(r.jsx)(X.a,{color:"inherit"}),children:w.map((function(e,n){return Object(r.jsx)(de,{project:t,keyStr:"treeNode-".concat(n),item:e,fileDict:S,fileClick:i},"treeNode-".concat(n))}))})]}),Object(r.jsx)(R.a,{open:Boolean(f),anchorEl:f?f[0]:null,onClose:function(){return j(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(r.jsx)(T.a,{className:m.popOver,children:f?f[1]:""})})]})},ge=t(68),he=t(29),fe=t(194),je=t(363),be=t(362),Oe=t(479),ve=t(567),ye=t(568),xe=Object(b.a)((function(e){return{root:{padding:e.spacing(2),margin:e.spacing(2)},itemText:{flexGrow:1},spacer:{flexGrow:1},itemLine:{display:"flex"},mm:{display:"flex",width:"100%"},odd:{background:e.palette.background.default},mmItem:{},prodChip:{height:e.spacing(2.3),borderRadius:e.spacing(1)/2,color:"#999",border:"1px solid #ddd",background:"#eee",marginRight:e.spacing(1)},downloadText:{textAlign:"center",width:"100%"}}})),Se=function(e){var n=e.project,t=e.onClick,a=e.program,o=e.pendingZips,i=e.odd,c=e.downloadZipFile,l=xe(),d=o[n.id],p=a.products.find((function(e){return e.id===n.projType})),m=p?p.pathArr.filter((function(e){return"Collection"===e.type})):[],g=p?p.name:"<UNKNOWN>",h=m.map((function(e){return{key:e.name,val:n.meta[e.name]}}),{});return Object(r.jsxs)(be.a,{button:!0,onClick:t,className:Object(Q.default)(Object(u.a)({},l.odd,i)),children:[Object(r.jsx)(Oe.a,{children:Object(r.jsxs)(ve.a,{children:[" ",n.projType&&n.projType.substr(0,1)," "]})}),Object(r.jsxs)("div",{className:l.itemText,children:[Object(r.jsxs)("div",{className:l.itemLine,children:[Object(r.jsx)(T.a,{variant:"body1",children:n.name}),Object(r.jsx)("div",{className:l.spacer}),Object(r.jsx)(K.WarehouseTags,{tags:n.tags,chipProps:{size:"small",color:"secondary"}})]}),Object(r.jsxs)("div",{className:l.mm,children:[Object(r.jsx)(ye.a,{className:l.prodChip,label:g,size:"small"}),h.map((function(e,n){var t=e.key,o=e.val,i=a.collections.find((function(e){return e.name===t})),c=i&&i.color?i.color[500]:"inherit";return Object(r.jsxs)(T.a,{className:l.mmItem,variant:"caption",color:"textSecondary",children:[n>0&&" \u2022 ",Object(r.jsxs)("span",{style:{color:c},children:[" ",o," "]})]},"mmval-".concat(n))}))]})]}),Object(r.jsx)(se,Object(s.a)({},{project:n,pendingSince:d,downloadZipFile:c}))]})},we=t(981),Pe=t(987),Te=Object(b.a)((function(){return{root:{},itemText:{flexGrow:1}}})),Ne=function(){var e=Te();return Object(r.jsxs)(be.a,{children:[Object(r.jsx)(Oe.a,{children:Object(r.jsx)(Pe.a,{variant:"circle",height:40,width:40})}),Object(r.jsxs)("div",{className:e.itemText,children:[Object(r.jsx)(Pe.a,{style:{height:10,width:"60%",margin:"6px 0"}}),Object(r.jsx)(Pe.a,{style:{height:10,width:"40%",margin:"6px 0"}})]}),Object(r.jsx)(we.a,{children:Object(r.jsx)(E.a,{edge:"end",disabled:!0,children:Object(r.jsx)(Pe.a,{variant:"circle",height:40,width:40})})})]})},Ce=Object(b.a)((function(e){return{root:{padding:e.spacing(2),margin:e.spacing(2)}}})),ke=function(e){var n=e.data,t=e.program,a=e.loading,o=e.searchParams,i=e.setSearchParams,c=e.pendingZips,l=e.navigate,u=e.downloadZipFile,d=Ce();return a?Object(r.jsxs)(fe.a,{className:d.root,children:[Object(r.jsx)(ge.c,{data:{total:0,startIndex:o.nextToken,pageSize:o.limit},loading:a,handlePaginationEvent:function(e){return i(Object(s.a)(Object(s.a)({},o),{},{nextToken:e}))}}),Object(r.jsx)(A.a,{}),Object(r.jsx)(je.a,{children:Array(o.limit||10).fill(null).map((function(e,n){return Object(r.jsx)(Ne,{},"result-".concat(n))}))})]}):n&&n.projects&&0!==n.projects.length?Object(r.jsxs)(fe.a,{className:d.root,children:[Object(r.jsx)(ge.c,{data:{total:n.total,startIndex:o.nextToken,pageSize:o.limit},handlePaginationEvent:function(e){return i(Object(s.a)(Object(s.a)({},o),{},{nextToken:e}))}}),Object(r.jsx)(A.a,{}),Object(r.jsx)(je.a,{children:n&&n.projects.map((function(e,n){var a=new he.Project(e);return Object(r.jsx)(Se,{odd:Boolean(n%2),project:a,program:t,pendingZips:c,downloadZipFile:u,onClick:function(){return l(t.machineName,a.id)}},"result-".concat(n))}))})]}):Object(r.jsx)(fe.a,{className:d.root,children:Object(r.jsx)("div",{children:"No Projects Found"})})},Ie=function(e){var n=e.getCurrentToken,t=e.url,o=e.navigate,i=e.program,c=e.searchParams,s=e.setSearchParams,u=e.pendingZips,d=e.downloadZipFile,g=Object(a.useState)(!0),h=Object(l.a)(g,2),f=h[0],b=h[1],O=Object(a.useState)(),v=Object(l.a)(O,2),y=v[0],x=v[1],S=Object(a.useState)(),w=Object(l.a)(S,2),P=w[0],T=w[1];return P&&j.a.error(P),Object(a.useEffect)((function(){function e(){return(e=Object(m.a)(p.a.mark((function e(){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return b(!0),e.next=5,n();case 5:return r=e.sent,j.a.debug("Search API Hit",{url:t,jwt:r,program:i.machineName,searchParams:c}),e.next=9,Object(he.search)(t,r,i.machineName,c).then((function(e){var n=e.data,t=e.errors;try{if(t&&t.length>0)T(t),b(!1);else if(n){var r=n.search;x(r),b(!1)}}catch(a){b(!1)}})).catch((function(e){b(!1),T([e])}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}x(void 0),function(){e.apply(this,arguments)}()}),[i,t,c,n]),Object(r.jsx)(ke,{data:y,loading:f,navigate:o,program:i,searchParams:c,setSearchParams:s,pendingZips:u,downloadZipFile:d})};Ie.whyDidYouRender=!0;var Ee=Ie,Ae=t(162),_e=t(984),De=t(365),Re=t(932),$e=t(447),Ue=t(927),Fe=t(579),Le=t.n(Fe),Me=t(188),We=t(187),Be=t(476),Ge=t(477),ze=t(478),qe=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GRAPHQL:"https://gco5qebdt4.execute-api.us-west-2.amazonaws.com/production/api",REACT_APP_VERSION:"1.2.4"}).REACT_APP_DOMAIN;j.a.debug("config: ",{domain:qe});var Ze="1.2.4",Ve={graphql:"".concat("https://gco5qebdt4.execute-api.us-west-2.amazonaws.com/production/api")},Xe="/RiverscapesLogo.png",Ke={limit:10,nextToken:0},Qe=[ne.a,re.a,Me.a,We.a,te.a,Be.a,Ge.a,ze.a],He=new URL("".endsWith("/")?"":"/",window.location.origin);console.log("RedirectUrl",{redirectUrl:He,publicUrl:""});var Je=t(217),Ye=Object(b.a)((function(e){return{root:{display:"flex"},advancedLeft:{flex:"1 1 30%",height:e.spacing(4),marginRight:e.spacing(1)},advancedLeftCustom:{textAlign:"center"},advancedLeftOption:{},advancedText:{flex:"1 1 70%"},advancedRight:{flex:"1 1 70%"},advancedOp:{display:"flex"},advancedTextCustomName:{flex:"1 1 30%",marginRight:e.spacing(1)},advancedTextCustomValue:{flex:"1 1 40%"},advancedOpName:{flexGrow:1},advancedOpNamId:{},advancedInput:{height:e.spacing(4)}}})),en=function(e){var n=e.row,t=e.options,i=e.changeHandler,c=Ye(),s=Object(l.a)(n,2),u=s[0],d=s[1],p=Object(a.useState)(null),m=Object(l.a)(p,2),g=m[0],h=m[1],f=u&&u.length>0&&t.find((function(e){return e.name.toLowerCase()===u.toLowerCase()})),b=f&&f.Allow&&!!f.Allow.find((function(e){return e.name.toLowerCase()&&e.name.length>0})),O=Je.util.debounce((function(e,n){var t=String(e),r=String(n);if(r&&r.length>0&&f&&!b){var a=f.AllowRegex;if(a&&a.length>0){var o=[];if(a.forEach((function(e){var n=new RegExp(e);!r.match(n)&&o.push(e)})),o.length>0)return void(1===o.length?h("Value must match pattern: '".concat(o[0],"'")):h(o.reduce((function(e,n,t){return e+(t>0?" and ":"")+n}),"Value must match patterns: ")))}}h(null),j.a.debug("CHANGING VALUES",[t,r]),t.toLowerCase()===u.toLowerCase()&&r.toLowerCase()===d.toLowerCase()||i([t,r])}),500),v=function(e){13===e&&u&&u.length>0&&(j.a.debug("Enter pressed"),i([u,d],!0))};return Object(r.jsxs)("div",{className:c.root,children:[Object(r.jsx)(De.a,{className:c.advancedLeft,children:Object(r.jsxs)(Re.a,{value:f?f.name:"__custom",inputProps:{className:c.advancedInput},onChange:function(e){return i([String(e.target.value),""],!0)},children:[Object(r.jsx)($e.a,{value:"__custom",children:Object(r.jsx)(T.a,{className:c.advancedLeftCustom,color:"textSecondary",children:Object(r.jsx)("em",{children:"Custom"})})},"aoss-custom"),t.map((function(e,n){var t=e.name;return Object(r.jsx)($e.a,{value:t,children:Object(r.jsx)(T.a,{className:c.advancedLeftOption,children:t})},"aoss-".concat(n))}))]})}),b?Object(r.jsx)(De.a,{className:c.advancedRight,children:Object(r.jsx)(Re.a,{value:d,inputProps:{className:c.advancedInput},onChange:function(e){return i([u,String(e.target.value)],!0)},children:f&&f.Allow&&f.Allow.map((function(e,n){var t=e.id,a=e.name;return Object(r.jsxs)($e.a,{className:c.advancedOp,value:t,children:[Object(r.jsx)(T.a,{className:c.advancedOpName,children:a}),a!==t&&Object(r.jsx)(T.a,{variant:"caption",className:c.advancedOpNamId,children:t})]},"aooptss-".concat(n))}))})}):f?Object(r.jsx)(_e.a,{error:!!g,label:g,disabled:!u||0===u.length,placeholder:"...",defaultValue:d,className:c.advancedText,inputProps:{className:c.advancedInput},onKeyDown:function(e){return v(e.keyCode)},onChange:function(e){return O(u,e.target.value)}}):Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(_e.a,{placeholder:"Meta Name",defaultValue:"",className:c.advancedTextCustomName,inputProps:{className:c.advancedInput},onKeyDown:function(e){return v(e.keyCode)},onChange:function(e){return O(e.target.value,d)}}),Object(r.jsx)(_e.a,{placeholder:"Meta Value",defaultValue:"",className:c.advancedTextCustomValue,inputProps:{className:c.advancedInput},onKeyDown:function(e){return v(e.keyCode)},onChange:function(e){return O(u,e.target.value)}})]})]})},nn=Object(b.a)((function(e){return{root:{padding:e.spacing(2),margin:e.spacing(2)},spacer:{flexGrow:1},actionBar:{display:"flex",width:"100%","&>*":{marginLeft:e.spacing(1)}},advanced:{},iconButton:{},textField:{},projTypeLine:{display:"flex"},projType:{marginRight:e.spacing(1),flexGrow:1,maxWidth:300},resultsNum:{flexShrink:0},projTypeMenuItem:{display:"flex"},projTypeMenuItemSelected:{display:"flex"},projTypeMenuItemName:{flexGrow:1},projTypeMenuItemNum:{color:e.palette.text.secondary,fontSize:"0.75rem"}}})),tn=function(e){var n,t,o,i,c=e.projTotals,u=e.program,d=e.searchParams,p=e.setSearchParams,m=nn(),g=Object(a.useState)([]),h=Object(l.a)(g,2),f=h[0],j=h[1],b=Object(a.useRef)(d),O=Object(a.useRef)(),v=Object(a.useRef)();function y(e,n){var t=Object(s.a)({},e||b.current||d),r=Object(Ae.a)(n||f);"__all"===t.projType&&delete t.projType;var a=r&&r.length>0&&r.filter((function(e){var n=Object(l.a)(e,2),t=n[0],r=n[1];return t&&r&&t.length>0&&r.length>0})),o=Object(s.a)(Object(s.a)({},t),{},{nextToken:0});a&&a.length>0&&(o.metaArr=JSON.stringify(a)),n&&j(n),p(o)}b.current=d;var x=function(e){if(!e)return"";try{return JSON.parse(e).join(", ")}catch(n){return""}};Object(a.useEffect)((function(){O.current&&(O.current.value=d.metaStr||""),v.current&&(d&&!0===d.noTags?v.current.value="NO_TAGS":v.current.value=x(d.tags)||"")}),[d]);var w=u&&u.products?Object.values(u.products).map((function(e){return{name:e.name,id:e.id}})):[],P=u?u.collections:[];P.sort((function(e,n){return e.name.toLowerCase()<n.name.toLowerCase()?-1:e.name.toLowerCase()>n.name.toLowerCase()?1:0})),w.sort((function(e,n){return e.name.toLowerCase()<n.name.toLowerCase()?-1:e.name.toLowerCase()>n.name.toLowerCase()?1:0}));var T=function(e){var n=e.split(",").map((function(e){return e.trim()})).filter((function(e){return e&&e.length>0}));return 0===n.length?void 0:JSON.stringify(n)},N=function(e){13===e.keyCode&&y(b.current)};return Object(r.jsxs)(fe.a,{className:m.root,children:[u&&u.products&&Object(r.jsxs)("div",{className:m.projTypeLine,children:[Object(r.jsxs)(De.a,{fullWidth:!0,className:m.projType,children:[Object(r.jsx)(Ue.a,{htmlFor:"projectType",children:"Project Type"}),Object(r.jsxs)(Re.a,{id:"projectType",inputProps:{className:m.projTypeMenuItemSelected},value:(null===(n=b.current)||void 0===n?void 0:n.projType)||"__all",onChange:function(e){var n="_all"!==e.target.value?e.target.value:void 0;y(Object(s.a)(Object(s.a)({},b.current),{},{projType:n}))},children:[Object(r.jsxs)($e.a,{className:m.projTypeMenuItem,value:"__all",children:[Object(r.jsx)("div",{className:m.projTypeMenuItemName,children:"All Project Types"}),Object(r.jsx)("div",{className:m.projTypeMenuItemNum,children:c.__all>-1?"".concat(c.__all):"..."})]}),w.map((function(e,n){var t=e.name,a=e.id;return Object(r.jsxs)($e.a,{className:m.projTypeMenuItem,value:a,children:[Object(r.jsx)("div",{className:m.projTypeMenuItemName,children:t}),Object(r.jsx)("div",{className:m.projTypeMenuItemNum,children:c[a]>-1?"".concat(c[a]):"..."})]},"prod-".concat(n))}))]})]}),Object(r.jsx)("div",{className:m.spacer}),Object(r.jsx)(De.a,{fullWidth:!0,className:m.projType,children:Object(r.jsx)(_e.a,{id:"tagSearch",label:"Tag Search",autoFocus:!0,placeholder:"Term1, term2, ... or NO_TAGS",inputRef:v,defaultValue:x(null===(t=b.current)||void 0===t?void 0:t.tags),onKeyDown:N,onChange:function(e){e.target.value&&"NO_TAGS"===e.target.value.trim()?b.current=Object(s.a)(Object(s.a)({},b.current),{},{noTags:!0,tags:void 0}):b.current=Object(s.a)(Object(s.a)({},b.current),{},{noTags:void 0,tags:T(e.target.value)})}})}),Object(r.jsxs)(De.a,{className:m.resultsNum,children:[Object(r.jsx)(Ue.a,{htmlFor:"resultsNum",children:"Results"}),Object(r.jsxs)(Re.a,{id:"resultsNum",value:null===(o=b.current)||void 0===o?void 0:o.limit,onChange:function(e){y(Object(s.a)(Object(s.a)({},b.current),{},{limit:e.target.value}))},children:[Object(r.jsx)($e.a,{value:10,children:"10"}),Object(r.jsx)($e.a,{value:20,children:"20"}),Object(r.jsx)($e.a,{value:50,children:"50"}),Object(r.jsx)($e.a,{value:100,children:"100"})]})]})]}),Object(r.jsx)(_e.a,{id:"outlined-helperText2",label:"Metadata Search",fullWidth:!0,autoFocus:!0,placeholder:"...",inputRef:O,className:m.textField,margin:"normal",variant:"outlined",defaultValue:(null===(i=b.current)||void 0===i?void 0:i.metaStr)||"",onKeyDown:N,onChange:function(e){b.current=Object(s.a)(Object(s.a)({},b.current),{},{metaStr:e.target.value})}}),f.length>0&&Object(r.jsxs)("div",{className:m.advanced,children:[f.map((function(e,n){return Object(r.jsx)(en,{row:e,options:P.filter((function(e){return!f.find((function(t,r){return r!==n&&t[0]===e.name}))})),changeHandler:function(e,t){var r=Object(Ae.a)(f);r[n]=e,j(r),t&&y(null,r)}},"advRow-".concat(n))})),Object(r.jsxs)("div",{children:[Object(r.jsx)(S.a,{onClick:function(){return y(null,[].concat(Object(Ae.a)(f),[["",""]]))},children:"+"}),Object(r.jsx)(S.a,{onClick:function(){return y(null,f.slice(0,-1))},children:"-"})]})]}),Object(r.jsxs)("div",{className:m.actionBar,children:[Object(r.jsxs)(S.a,{color:"primary",onClick:function(){b.current&&(f.length>0?y(b.current,[]):y(b.current,[["",""]]))},children:[f.length>0?"Hide":"Show"," Advanced"]}),Object(r.jsx)("div",{className:m.spacer}),Object(r.jsxs)(S.a,{className:m.iconButton,color:"primary",variant:"contained",onClick:function(){y(b.current)},children:[Object(r.jsx)(Le.a,{})," Search"]}),Object(r.jsx)(S.a,{className:m.iconButton,color:"secondary",variant:"contained",onClick:function(){j([]),y(Ke)},children:"Reset"})]})]})},rn=function(e){var n=e.getCurrentToken,t=e.url,o=e.program,i=e.searchParams,c=e.setSearchParams,d=Object(a.useState)({}),p=Object(l.a)(d,2),m=p[0],g=p[1],h=Object(a.useRef)();return h.current=m,Object(a.useEffect)((function(){o&&t&&(n().then((function(e){return Object(he.search)(t,e,o.machineName,{limit:0})})).then((function(e){var n=e.data;return n&&g(Object(s.a)(Object(s.a)({},h.current),{},{__all:n.search?n.search.total:0}))})).catch((function(e){j.a.error(e)})),o.products.reduce((function(e,r){return e.then((function(){return n().then((function(e){return Object(he.search)(t,e,o.machineName,{projType:r.id,limit:0})})).then((function(e){var n=e.data;n&&g(Object(s.a)(Object(s.a)({},h.current),{},Object(u.a)({},r.id,n.search?n.search.total:0)))})).catch((function(e){g(Object(s.a)(Object(s.a)({},h.current),{},Object(u.a)({},r.id,0))),j.a.error(e)}))}))}),Promise.resolve()))}),[o,t,n]),Object(r.jsx)(tn,{projTotals:m,program:o,searchParams:i,setSearchParams:c})};rn.whyDidYouRender=!0;var an=rn,on=function(e,n,t){var r=Object(a.useState)(),o=Object(l.a)(r,2),i=o[0],c=o[1],u=Object(a.useRef)();return u.current=i,Object(a.useEffect)((function(){if(e&&n&&e.params&&e.params.program)try{var r=null===n||void 0===n?void 0:n.find((function(n){return n.machineName===e.params.program}));!r||u.current&&u.current.machineName===r.machineName||(r.collections=r.collections.map((function(e,n){return Object(s.a)(Object(s.a)({},e),{},{color:Qe[n%Qe.length]})})),u.current=r,j.a.debug("useProgram",{match:e,newProg:r,programs:n}),c(r),t&&t(r))}catch(a){return}}),[e,n,t]),i},cn=function(e,n,t){var r=Object(a.useState)({loading:!1}),o=Object(l.a)(r,2),i=o[0],c=o[1],u=Object(a.useRef)();return u.current=i,Object(a.useEffect)((function(){if(n&&n.params){n.params.project||c({loading:!1});try{if(!t||!n||!n.params||!n.params.project||n.params.project.length<10)return;var r=t.machineName,a=!1;setTimeout((function(){a||c(Object(s.a)(Object(s.a)({},u.current),{},{loading:!0}))}),500),e.getCurrentToken().then((function(e){return Object(he.getProject)(Ve.graphql,e,n.params.project,r)})).then((function(e){var n;a=!0,j.a.debug("getProjectById::Response",e),e.data&&u.current&&u.current.project&&(null===(n=u.current)||void 0===n?void 0:n.project.id)===e.data.project.id||(e.data?c({project:e.data.project,loading:!1}):c({project:void 0,loading:!1}))})).catch((function(e){a=!0,c({project:void 0,loading:!1}),j.a.error("api.getProjectById error",e)}))}catch(o){return}}}),[n,t,e]),i},sn=Ve.graphql,ln=function(e){var n=e.match,t=e.history,i=e.auth,c=e.programs,d=Object(a.useState)({}),g=Object(l.a)(d,2),f=g[0],b=g[1],O=Object(a.useState)(Ke),v=Object(l.a)(O,2),y=v[0],x=v[1],S=Object(a.useRef)();S.current=f;var w=Object(a.useCallback)((function(e){x(Ke)}),[]),P=on(n,c,w),N=cn(i,n,P),k=N.project,I=N.loading,E=Object(a.useCallback)((function(e,n){n&&n.length>10?t.push("/"+e+"/"+n):t.push("/"+e)}),[t]),A=Object(a.useCallback)(function(){var e=Object(m.a)(p.a.mark((function e(n,t){var r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return e.prev=2,e.next=5,i.getCurrentToken();case 5:return r=e.sent,e.next=8,Object(he.downloadFile)(Ve.graphql,r,n.projType,P.machineName,n.id,t);case 8:a=e.sent;try{a.data&&window.open(a.data.downloadFile.downloadUrl,"_self")}catch(o){j.a.error("DOWNLOAD err",o)}e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),j.a.error("DOWNLOAD err",e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(n,t){return e.apply(this,arguments)}}(),[P,i]),_=Object(a.useCallback)((function(e){if(!P)return Promise.resolve();return function n(){return i.getCurrentToken().then((function(n){return Object(he.downloadZipFile)(Ve.graphql,n,e.projType,P.machineName,e.id)})).then((function(t){try{t.data&&!t.data.downloadZip.pendingSince?(b(h.a.pickBy(S.current,(function(n,t){return t!==e.id}))),window.open(t.data.downloadZip.downloadUrl,"_self")):(b(Object(s.a)(Object(s.a)({},S.current),{},Object(u.a)({},e.id,t.data?t.data.downloadZip.pendingSince:Date.now()))),setTimeout(n,5e3))}catch(r){j.a.error("DOWNLOAD err",r)}})).catch((function(e){j.a.error("DOWNLOAD err",e)}))}()}),[P,i]),D=Object(a.useMemo)((function(){return k&&Object(r.jsx)(me,{program:P,project:k,onClose:function(){P&&E(P.machineName)},downloadFile:A,pendingZips:f,downloadZipFile:_})}),[k,A,_,E,f,P]),R=P&&Object.values(he.WarehouseRoleEnum).indexOf(P.role)>-1;j.a.info("App.Connect",{hasViewAccess:R,program:P});var $=Object(a.useMemo)((function(){return Object(r.jsxs)(o.a.Fragment,{children:[Object(r.jsx)(an,Object(s.a)({},{getCurrentToken:i.getCurrentToken,url:sn,program:P,searchParams:y,setSearchParams:x})),Object(r.jsx)(Ee,Object(s.a)({},{getCurrentToken:i.getCurrentToken,url:sn,navigate:E,program:P,searchParams:y,setSearchParams:x,pendingZips:f,downloadZipFile:_}))]})}),[y,P,f,_,i.getCurrentToken,E]);return R?Object(r.jsxs)(o.a.Fragment,{children:[I&&Object(r.jsx)(ge.b,{logoSVG:Object(r.jsx)(ae.a,{size:"7rem",thickness:7}),status:Object(r.jsx)(T.a,{variant:"h5",component:"div",children:"Loading Project..."}),containerProps:{maxWidth:"xl",style:{position:"absolute",zIndex:1e3,top:0,left:0,width:"100%",height:"100%",background:"#FFFFFF77"}}}),$,D]}):Object(r.jsx)(C,{program:P,onClose:function(){return t.push("/")}})},un=t(55),dn=t(595),pn=t(444),mn=t(592),gn=t.n(mn),hn=t(366),fn=t.n(hn),jn=t(591),bn=t.n(jn),On=t(978),vn=t(480),yn=t(983),xn=Object(b.a)((function(e){return{root:{},allowSelect:{userSelect:"text",cursor:"auto"},google:Object(s.a)(Object(s.a)({},e.typography.caption),{},{borderRadius:e.spacing(1.5),padding:e.spacing(.5,1),background:e.palette.primary.main,color:e.palette.primary.contrastText,marginLeft:e.spacing(2),border:"1px solid ".concat(e.palette.primary.dark)}),removeIcon:{marginLeft:e.spacing(2)}}})),Sn=function(e){var n=e.user,t=e.onChange,a=e.isSuperUser,o=xn(),i=n.loading,c=function(e,r){e===he.WarehouseRoleEnum.Admin?t(n.username,r?he.WarehouseRoleEnum.Admin:he.WarehouseRoleEnum.Participant):e===he.WarehouseRoleEnum.Participant&&t(n.username,r?he.WarehouseRoleEnum.Participant:he.WarehouseRoleEnum.Observer)},s=n.role===he.WarehouseRoleEnum.SuperUser;return Object(r.jsxs)(be.a,{disabled:i||s,className:o.root,divider:!0,children:[Object(r.jsx)(Oe.a,{children:n.picture&&n.picture.length>0?Object(r.jsx)(ve.a,{alt:n.name,src:n.picture}):Object(r.jsx)(ve.a,{alt:n.name,children:Object(r.jsx)(fn.a,{color:"inherit"})})}),Object(r.jsx)(vn.a,{id:"switch-list-label-wifi",primary:Object(r.jsxs)("span",{children:[Object(r.jsx)("span",{className:o.allowSelect,children:n.name}),n.username.startsWith("google")&&Object(r.jsx)("span",{className:o.google,children:"Google"})]}),secondary:Object(r.jsx)("span",{className:o.allowSelect,children:n.email})}),n.role&&Object(r.jsxs)(we.a,{children:[a&&!s&&Object(r.jsx)(On.a,{control:Object(r.jsx)(yn.a,{edge:"end",onChange:function(e){return c(he.WarehouseRoleEnum.Admin,e.target.checked)},checked:[he.WarehouseRoleEnum.Admin,he.WarehouseRoleEnum.SuperUser].indexOf(n.role)>-1,disabled:i||[he.WarehouseRoleEnum.Observer].indexOf(n.role)>-1,inputProps:{"aria-labelledby":"switch-list-label-wifi"}}),labelPlacement:"start",label:"Program Admin"}),!s&&Object(r.jsx)(On.a,{control:Object(r.jsx)(yn.a,{edge:"end",onChange:function(e){return c(he.WarehouseRoleEnum.Participant,e.target.checked)},checked:[he.WarehouseRoleEnum.Participant,he.WarehouseRoleEnum.Admin,he.WarehouseRoleEnum.SuperUser].indexOf(n.role)>-1,disabled:i||[he.WarehouseRoleEnum.Admin,he.WarehouseRoleEnum.SuperUser].indexOf(n.role)>-1,inputProps:{"aria-labelledby":"switch-list-label-wifi"}}),labelPlacement:"start",label:"Participant"}),!s&&Object(r.jsx)(I.a,{title:"Remove this user from the program",children:Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(E.a,{edge:"end",className:o.removeIcon,"aria-label":"delete",color:"secondary",disabled:i,onClick:function(){return t(n.username,null)},children:Object(r.jsx)(bn.a,{})})})})]}),!n.role&&Object(r.jsx)(we.a,{children:Object(r.jsx)(I.a,{title:"Add this user to the program",children:Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(E.a,{edge:"end","aria-label":"delete",color:"secondary",disabled:i,onClick:function(){return t(n.username,he.WarehouseRoleEnum.Observer)},children:Object(r.jsx)(gn.a,{})})})})})]})},wn=t(979),Pn=t(600),Tn=t(593),Nn=t.n(Tn),Cn=Object(b.a)((function(e){return{root:{display:"flex",overflow:"hidden",flexDirection:"column",margin:e.spacing(2)},description:{margin:e.spacing(0,2)},list:{flexGrow:1,overflow:"scroll",margin:e.spacing(1,2)},formControl:{margin:e.spacing(1,2)}}})),kn=function(e){var n=e.users,t=e.onChange,o=e.title,i=e.description,c=e.isSuperUser,s=Cn(),u=Object(a.useState)(),d=Object(l.a)(u,2),p=d[0],m=d[1],g=Object(a.useMemo)((function(){if(p&&p.length>=3){var e=p.split(" ").filter((function(e){return e.length>=3}));return n.filter((function(n){return e.every((function(e){return n.name.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1||n.email.toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1}))}))}return n}),[n,p]);return Object(r.jsxs)(fe.a,{className:s.root,children:[Object(r.jsx)(pn.a,{children:Object(r.jsx)(T.a,{variant:"subtitle1",children:o})}),Object(r.jsx)(T.a,{className:s.description,variant:"caption",children:i||" "}),Object(r.jsx)(De.a,{className:s.formControl,children:Object(r.jsx)(Pn.a,{fullWidth:!0,onChange:function(e){return m(e.target.value)},startAdornment:Object(r.jsx)(wn.a,{position:"start",children:Object(r.jsx)(Nn.a,{})})})}),Object(r.jsx)(je.a,{className:s.list,children:g.map((function(e,n){return Object(r.jsx)(Sn,{user:e,onChange:t,isSuperUser:c},"userRow-".concat(n))}))})]})},In=Object(b.a)((function(e){return{rootContainer:{height:"100%",width:"100%",overflow:"hidden",position:"relative"},root:{height:"100%",width:"100%",display:"flex",overflow:"hidden",flexDirection:"column"},paperContainer:{display:"flex",width:"100%",height:"100%",overflow:"hidden","&>:first-child":{flex:"1 1 60%"},"&>:last-child":{flex:"1 1 40%"}},instructions:{color:e.palette.primary.contrastText,background:e.palette.primary.main,margin:e.spacing(2),padding:e.spacing(2)},list:{flexGrow:1,overflow:"scroll",margin:e.spacing(1,2)},loading:{background:"#FFFFFFCC",position:"absolute",zIndex:1e3}}}));function En(e){e.sort((function(e,n){return e.name.toLowerCase().localeCompare(n.name.toLowerCase())}))}var An=function(e){var n=e.users,t=e.program,a=e.loading,o=e.isSuperUser,i=e.onChange,c=In(),s=n.filter((function(e){return e.role}));En(s);var l=n.filter((function(e){return!e.role}));En(l);var u=t&&t.meta&&t.meta.access&&"PUBLIC"===t.meta.access,d=Object(r.jsx)("img",{src:Xe,alt:"logo"});return Object(r.jsxs)("div",{className:c.rootContainer,children:[a&&Object(r.jsx)(ge.b,{logoSVG:d,title:"Riverscapes Warehouse",message:"Loading Users: ".concat(n.length),containerProps:{maxWidth:"xl",className:c.loading}}),Object(r.jsxs)("div",{className:c.root,children:[Object(r.jsxs)(fe.a,{className:c.instructions,children:[Object(r.jsxs)(T.a,{variant:"h4",color:"inherit",children:["User admin: ",t&&t.name]}),u?Object(r.jsxs)(T.a,{variant:"body2",color:"inherit",children:["This program is ",Object(r.jsx)("strong",{children:"public"}),". All authenticated users in the Riverscapes user pool will be able to see and download projects.",Object(r.jsx)("strong",{children:"Participants"})," can add or remove projects."]}):Object(r.jsxs)(T.a,{variant:"body2",color:"inherit",children:["This program is ",Object(r.jsx)("strong",{children:"private"})," so you have to explicitly add users to view it."," ",Object(r.jsx)("strong",{children:"Participants"})," can add or remove projects."]})]}),Object(r.jsxs)("div",{className:c.paperContainer,children:[Object(r.jsx)(kn,{users:s,onChange:i,isSuperUser:o,title:"Current program users:",description:"Everyone in this list is an Observer and can view and download all projects."}),Object(r.jsx)(kn,{users:l,onChange:i,isSuperUser:o,title:"Add users:",description:u?"Users in this list CAN see everything in the program because the program is PUBLIC":"Users in this list cannot see or donwload projects in this program"})]})]})]})},_n=function(e){var n=e.match,t=e.programs,o=e.auth,i=e.history,c=Object(a.useState)({users:[],loading:!0}),u=Object(l.a)(c,2),d=u[0],g=u[1],h=Object(a.useRef)(),f=Object(a.useRef)();h.current=d;var b=on(n,t);Object(a.useEffect)((function(){i&&b&&b.role!==he.WarehouseRoleEnum.SuperUser&&b.role!==he.WarehouseRoleEnum.Admin&&i.push("/".concat(b.machineName))}),[b,i]),Object(a.useEffect)((function(){function e(){return(e=Object(m.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0;case 1:if(!n&&!f.current){e.next=8;break}return n=!1,e.next=5,o.getCurrentToken().then((function(e){return Object(he.adminGetUsers)(Ve.graphql,e,null===b||void 0===b?void 0:b.machineName,50,f.current)})).then((function(e){var n,t,r,a=null===(n=e.data)||void 0===n?void 0:n.getUsers.nextToken,i=o.user?o.user.accessToken.payload.username:"NOBODY",c=((null===(t=e.data)||void 0===t?void 0:t.getUsers.users)||[]).filter((function(e){return e.username!==i}));return g({users:[].concat(Object(Ae.a)((null===(r=h.current)||void 0===r?void 0:r.users)||[]),Object(Ae.a)(c)),loading:Boolean(a)}),a})).catch((function(e){j.a.error(e)}));case 5:f.current=e.sent,e.next=1;break;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}b&&o&&function(){e.apply(this,arguments)}()}),[b,o]);var O=Object(a.useCallback)((function(e,n){var t=h.current.users.find((function(n){return n.username===e}));if(!t)throw new Error("Could not find user to change permissions of");var r=Object.assign({},t);g(Object(s.a)(Object(s.a)({},h.current),{},{users:h.current.users.map((function(t){return t.username!==e?t:Object(s.a)(Object(s.a)({},t),{},{role:n,loading:!0})}))}));var a=function(){j.a.error("ADMIN:::Operation failed. Putting the record back"),g(Object(s.a)(Object(s.a)({},h.current),{},{users:h.current.users.map((function(n){return n.username!==e?n:r}))}))},i=setTimeout(a,3e3);return o.getCurrentToken().then((function(t){return Object(he.adminUpdateUserPermissions)(Ve.graphql,t,e,null===b||void 0===b?void 0:b.machineName,n)})).then((function(n){clearTimeout(i),g(Object(s.a)(Object(s.a)({},h.current),{},{users:h.current.users.map((function(t){var r;return t.username!==e?t:Object(s.a)(Object(s.a)(Object(s.a)({},t),null===(r=n.data)||void 0===r?void 0:r.updateUser),{},{loading:!1})}))})),j.a.debug("Admin UPDATE",n)})).catch((function(e){j.a.error("User update query failure",e),a()}))}),[o,b]);return Object(r.jsx)(An,{users:d.users,isSuperUser:Boolean(b&&b.role===he.WarehouseRoleEnum.SuperUser),onChange:O,loading:Boolean(d.loading),program:b})},Dn=t(594),Rn=t.n(Dn),$n=Object(b.a)((function(e){return{rootContainer:{height:"100%",display:"flex",flexDirection:"column"},spacer:{flexGrow:1},root:{padding:e.spacing(2,4,4,4)},logoContainer:{padding:e.spacing(2),textAlign:"center"},logo:{}}})),Un=function(e){var n=e.signIn,t=$n();return Object(r.jsxs)("div",{className:t.rootContainer,children:[Object(r.jsx)("div",{className:t.spacer}),Object(r.jsxs)(fe.a,{className:t.root,children:[Object(r.jsx)("div",{className:t.logoContainer,children:Object(r.jsx)("img",{className:t.logo,src:"/RiverscapesLogo.png",alt:"logo"})}),Object(r.jsx)(T.a,{paragraph:!0,variant:"body1",children:"Welcome to the Riverscapes Warehouse. Please click the button below to log in."}),Object(r.jsx)(T.a,{paragraph:!0,variant:"body1",children:"If you don't have an account you will be prompted to use your Google account or create a new account using another email address."}),Object(r.jsx)(S.a,{variant:"contained",onClick:n,color:"primary",fullWidth:!0,size:"large",startIcon:Object(r.jsx)(Rn.a,{}),children:"Sign In"})]}),Object(r.jsx)("div",{className:t.spacer})]})},Fn=t(975),Ln=t(179),Mn={palette:{primary:{main:t(184).a[500]},secondary:{main:We.a[600],contrastText:"#FFFFFF"},text:{}}},Wn=Object(s.a)(Object(s.a)({},Mn),{},{palette:Object(s.a)(Object(s.a)({},Mn.palette),{},{type:"dark"})}),Bn={home:Object(Ln.a)(Mn),homeDark:Object(Ln.a)(Wn)},Gn=function(e){var n=e.children,t=e.match,a=e.history,o=e.programs,i=e.signOut,c=e.containerProps,l=e.noScroll,u=on(t,o);return Object(r.jsx)(Fn.a,{theme:Bn.home,children:Object(r.jsx)(ge.a,{containerProps:Object(s.a)({maxWidth:u?"md":"sm"},c),noScroll:l,topbar:Object(r.jsx)(K.Topbar,{history:a,programs:o,title:"Riverscapes Warehouse",signOutHandler:i,program:u}),footer:Object(r.jsx)(K.Footer,{version:Ze}),children:Object(r.jsx)(r.Fragment,{children:n})})})},zn=function(){var e=Object(a.useState)(),n=Object(l.a)(e,2),t=n[0],o=n[1],i=Object(a.useState)(),c=Object(l.a)(i,2),u=c[0],d=c[1],p=Object(a.useState)(!0),m=Object(l.a)(p,2),g=m[0],h=m[1],f=Object(dn.a)(t,!1,false),b=Object(un.f)();Object(a.useEffect)((function(){Object(he.authCheck)(Ve.graphql,"").then((function(e){var n;j.a.debug("authResp",e);var t=null===(n=e.data)||void 0===n?void 0:n.auth;t&&t.region&&(o({region:t.region,userPoolId:t.userPool,userPoolWebClientId:t.clientId,mandatorySignIn:!0,oauth:{domain:t.domain,scope:["email","profile","openid"],redirectSignIn:He.toString(),redirectSignOut:He.toString(),responseType:"code"}}),h(!1))})).catch((function(e){j.a.error("api.getPrograms error",e)}))}),[]),Object(a.useEffect)((function(){if(b){var e=localStorage.getItem("RSUrl"),n=b.location.pathname;j.a.debug("LOCALSTORAGE:::REDIRECT checking",e,n,f),f.isAuthenticated||f.error||!f.isAuthComplete||(j.a.debug("LOCALSTORAGE:::SET",n),localStorage.setItem("RSUrl",n)),e&&f.isAuthenticated&&f.isAuthComplete&&!f.error&&(n!==e&&(j.a.debug("LOCALSTORAGE:::REDIRECT",n,e),b.push(e)),localStorage.removeItem("RSUrl"))}}),[b,f]);var O=Object(a.useCallback)((function(e,n,t){t?e.push("/"+n.machineName+"/"+t.id):e.push("/"+n.machineName)}),[]);Object(a.useEffect)((function(){f.isAuthenticated&&!(null===u||void 0===u?void 0:u.programs)&&(d({programs:[],loading:!0}),f.getCurrentToken().then((function(e){return Object(he.getPrograms)(Ve.graphql,e)})).then((function(e){j.a.debug("API GetPrograms",e),e.data&&e.data.programs&&d({programs:e.data.programs,loading:!1})})).catch((function(e){j.a.error("api.getPrograms error",e)})))}),[f,u]);var v=Object(r.jsx)("img",{src:Xe,alt:"logo"});if(g)return Object(r.jsx)(Gn,{children:Object(r.jsx)(ge.b,{logoSVG:v,title:"Riverscapes Warehouse",message:"Loading authentication info",version:Ze})});if(f.isAuthenticated){if(!u||(null===u||void 0===u?void 0:u.loading))return Object(r.jsx)(Gn,{children:Object(r.jsx)(ge.b,{logoSVG:v,title:"Riverscapes Warehouse",message:"Loading Programs",version:Ze})});var y={navigate:O,signOut:f.signOut,programs:null===u||void 0===u?void 0:u.programs};return Object(r.jsxs)(un.c,{children:[Object(r.jsx)(un.a,{path:"/:program/admin",render:function(e){return Object(r.jsx)(Gn,Object(s.a)(Object(s.a)(Object(s.a)({},e),y),{},{noScroll:!0,containerProps:{maxWidth:"lg"},children:Object(r.jsx)(_n,Object(s.a)(Object(s.a)({},e),{},{programs:null===u||void 0===u?void 0:u.programs,auth:f}))}))}}),Object(r.jsx)(un.a,{path:"/:program/:project?",render:function(e){return Object(r.jsx)(Gn,Object(s.a)(Object(s.a)(Object(s.a)({},e),y),{},{children:Object(r.jsx)(ln,Object(s.a)(Object(s.a)({},e),{},{auth:f,programs:null===u||void 0===u?void 0:u.programs}))}))}}),Object(r.jsx)(un.a,{path:"/",render:function(e){return Object(r.jsx)(Gn,Object(s.a)(Object(s.a)(Object(s.a)({},e),y),{},{containerProps:{maxWidth:"sm"},children:Object(r.jsx)(K.ProgramChooser,Object(s.a)(Object(s.a)({},e),{},{navigate:O,programs:null===u||void 0===u?void 0:u.programs}))}))}}),Object(r.jsx)(un.a,{path:"*",render:function(e){return Object(r.jsx)(Gn,Object(s.a)(Object(s.a)(Object(s.a)({},e),y),{},{children:"404 Not found"}))}})]})}return f.isAuthComplete?Object(r.jsx)(Gn,{noScroll:!0,children:Object(r.jsx)(Un,{signIn:f.signIn})}):Object(r.jsx)(Gn,{children:Object(r.jsx)(ge.b,{logoSVG:v,title:"Riverscapes Warehouse",message:"Authenticating",version:Ze})})},qn=t(259),Zn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Vn(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}t(910);Object(ge.d)(),t(911),c.a.render(Object(r.jsx)(qn.a,{basename:"/",children:Object(r.jsx)(zn,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");Zn?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var r=t.headers.get("content-type");404===t.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Vn(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Vn(n,e)}))}}(),window.addEventListener("load",(function(){window.history.pushState({},"")})),navigator.storage&&navigator.storage.persist?navigator.storage.persist().then((function(e){e?j.a.debug("Storage will not be cleared except by explicit user action"):j.a.warn("Storage may be cleared by the UA under storage pressure.")})):j.a.warn("navigator.storage API not implemented.")}},[[913,1,2]]]);
//# sourceMappingURL=main.b25fc375.chunk.js.map